!function(){angular.module("app.services",[])}(),function(){"use strict";function n(n){function e(e){return n.get("api/product/"+e).then(function(n){return n.data}).catch(function(n){console.log(n.message)})}function t(e){return n.get("api/product",{params:e}).then(function(n){return n.data}).catch(function(n){console.log(n.message)})}function o(e){return e.id?n.put("api/product",e).then(function(n){return n.data}).catch(function(n){return n.message}):n.post("api/product",e).then(function(n){return n.data}).catch(function(n){return n.message})}return{getProduct:e,getAllProducts:t,save:o}}n.$inject=["$http"];angular.module("app.services").factory("ProductService",n)}(),function(){"use strict";var n=angular.module("app",["app.services","app.directives","shared.components","ngComponentRouter","ui.bootstrap","smart-table"]);n.component("libraryApp",{templateUrl:"/app/product-app.component.html",$routeConfig:[{path:"/",name:"List",component:"list",useAsDefault:!0}]}),n.value("$routerRootComponent","libraryApp"),n.config(["stConfig",function(n){n.search.delay=2e3}])}(),function(){function n(n){var e=this;e.$onInit=function(){e.resolve&&(e.id=e.resolve.id),e.id&&n.get("api/publisher/"+e.id).then(function(n){e.publisher=n.data}).catch(function(n){console.log("Error retriving publisher",n.message)}).finally(function(){}),console.log("$ctrl",e)},e.cancel=function(){e.dismiss()},e.save=function(){return n.post("api/publisher",e.publisher).then(function(n){angular.extend(e.publisher,n.data)}).catch(function(n){console.log("Error saving publisher",n.message)}).finally(function(){console.log("edit publisher",e.publisher),e.modalInstance.close(e.publisher)})}}var e=angular.module("app");e.component("publisherEdit",{bindings:{id:"<",resolve:"<",close:"&",dismiss:"&",modalInstance:"<"},templateUrl:"app/publisher/publisher-edit.component.html",controller:["$http",n]})}(),function(){function n(n){var e=this;e.$onInit=function(){e.resolve&&(e.id=e.resolve.id,e.asModal=e.resolve.asModal,e.addStaffVisible=!1),n.getProduct(e.id).then(function(n){e.product=n})},e.createStaff=function(){console.log("add staff modal")},e.cancel=function(){e.dismiss()}}var e=angular.module("app");e.component("productSummary",{bindings:{id:"<",asModal:"<",resolve:"<",close:"&",dismiss:"&"},templateUrl:"app/product/product-summary.component.html",controller:["ProductService",n]})}(),function(){"use strict";function n(n,e){var t,o=this,i=10;o.searchModel={page:1,pageSize:i},o.$onInit=function(){},o.search=function(n){t=n,e.getAllProducts(o.searchModel).then(function(n){o.products=n.results,o.searchModel=n,delete o.searchModel.results})},o.paged=function(){o.search(t)},o.edit=function(e){n.open({component:"productEdit",bindings:{modalInstance:"<"},resolve:{id:e.id},size:"lg"}).result.then(function(n){angular.extend(e,n)},function(n){})},o.create=function(){n.open({component:"productEdit",bindings:{modalInstance:"<"},size:"lg"}).result.then(function(n){o.products.unshift(n)},function(n){console.info("I was dimissed, so do what I need to do myContent's controller now.  Reason was->"+n)})},o.showDetails=function(e){n.open({component:"productSummary",bindings:{modalInstance:"<"},resolve:{id:e,asModal:!0},size:"lg"}).result.then(function(n){console.info("I was closed, so do what I need to do myContent's controller now.  Result was->"),console.info(n)},function(n){console.info("I was dimissed, so do what I need to do myContent's controller now.  Reason was->"+n)})}}var e=angular.module("app");e.component("list",{templateUrl:"app/product/product-list.component.html",controller:["$uibModal","ProductService",n]})}(),function(){function n(n){var e=this;e.$onInit=function(){e.resolve&&(e.id=e.resolve.id),e.id&&n.getProduct(e.id).then(function(n){e.product=n})},e.cancel=function(){e.dismiss()},e.save=function(){return n.save(e.product).then(function(n){angular.extend(e.product,n)}).catch(function(n){console.log("Error saving product",n.message)}).finally(function(){e.modalInstance.close(e.product)})}}var e=angular.module("app");e.component("productEdit",{templateUrl:"app/product/product-edit.component.html",bindings:{id:"<",resolve:"<",close:"&",dismiss:"&",modalInstance:"<"},controller:["ProductService",n]})}(),function(){angular.module("app.directives",[])}(),function(){var n=angular.module("app.directives");n.directive("stSubmitSearch",["stConfig","$timeout","$parse",function(n,e,t){return{require:"^stTable",link:function(n,e,t,o){return e.bind("click",function(){console.log("search");var n=o;n.pipe()})}}}]),n.directive("clearKey",function(){return{restrict:"EA",require:"ngModel",link:function(n,e,t,o){e.on("keydown",function(e){27===e.which&&(o.$setViewValue(null),o.$render(),n.$apply())})}}}),n.directive("stResetSearch",function(){return{restrict:"EA",require:["^stTable","^ngModel"],link:function(n,e,t,o){return e.bind("click",function(){var e=o[1],t=o[0];return n.$apply(function(){angular.forEach(e.$viewValue,function(n,t){"page"===t.toLowerCase()&&(e.$viewValue[t]=1),Array.isArray(n)||_.includes(t.toLowerCase(),"page")||(e.$viewValue[t]=null)});var n=t.tableState();return n.search.predicateObject={},n.pagination.start=0,t.pipe()})})}}}),n.directive("stClearKey",function(){return{restrict:"EA",require:["^stTable","^ngModel"],link:function(n,e,t,o){e.on("keydown",function(t){var i=o[1],r=o[0];return 13===t.which?r.pipe():27===t.which?void 0!==e.context.attributes["st-search"]?n.$apply(function(){var n=e.context.attributes["st-search"].value,t=r.tableState();return t.search.predicateObject[n]="",r.pipe()}):n.$apply(function(){i.$setViewValue(null),i.$render()}):void 0})}}})}(),function(){angular.module("shared.components",[])}(),function(){function n(n,e){var t=this;t.$onInit=function(){n.get("api/publisher").then(function(n){t.publishers=n.data}).catch(function(n){console.log(n.message)})},t.create=function(){e.open({component:"publisherEdit",bindings:{modalInstance:"<"},size:"lg"}).result.then(function(n){console.info("I was closed, so do what I need to do myContent's controller now.  Result was->"),console.info("returning result",n),t.publishers.unshift(n),t.id=n.id},function(n){console.info("I was dimissed, so do what I need to do myContent's controller now.  Reason was->"+n)})},t.edit=function(){e.open({component:"publisherEdit",bindings:{modalInstance:"<"},resolve:{id:t.id},size:"lg"}).result.then(function(n){angular.forEach(t.publishers,function(e){e.id===t.id&&(angular.extend(e,n),t.id=e.id)})},function(n){console.info("I was dimissed, so do what I need to do myContent's controller now.  Reason was->"+n)})}}var e=angular.module("shared.components");e.component("publisherList",{bindings:{id:"="},templateUrl:"app/common/publisher-list.component.html",controller:["$http","$uibModal",n]})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZpY2VzL3NlcnZpY2VzLm1vZHVsZS5qcyIsInNlcnZpY2VzL3Byb2R1Y3Quc2VydmljZS5qcyIsInByb2R1Y3QtYXBwLm1vZHVsZS5qcyIsInB1Ymxpc2hlci9wdWJsaXNoZXItZWRpdC5jb21wb25lbnQuanMiLCJwcm9kdWN0L3Byb2R1Y3Qtc3VtbWFyeS5jb21wb25lbnQuanMiLCJwcm9kdWN0L3Byb2R1Y3QtbGlzdC5jb21wb25lbnQuanMiLCJwcm9kdWN0L3Byb2R1Y3QtZWRpdC5jb21wb25lbnQuanMiLCJkaXJlY3RpdmVzL2RpcmVjdGl2ZXMubW9kdWxlcy5qcyIsImRpcmVjdGl2ZXMvc3RUYWJsZS5kaXJlY3RpdmUuanMiLCJjb21tb24vY29tcG9uZW50cy5tb2R1bGUuanMiLCJjb21tb24vcHVibGlzaGVyLWxpc3QuY29tcG9uZW50LmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJzZXJ2aWNlQ29udHJvbGxlciIsIiRodHRwIiwiZ2V0UHJvZHVjdCIsImlkIiwiZ2V0IiwidGhlbiIsInIiLCJkYXRhIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwibWVzc2FnZSIsImdldEFsbFByb2R1Y3RzIiwic2VhcmNoTW9kZWwiLCJwYXJhbXMiLCJzYXZlIiwicHJvZHVjdCIsInB1dCIsInBvc3QiLCJmYWN0b3J5IiwiY29tcG9uZW50IiwidGVtcGxhdGVVcmwiLCIkcm91dGVDb25maWciLCJwYXRoIiwibmFtZSIsInVzZUFzRGVmYXVsdCIsInZhbHVlIiwiY29uZmlnIiwic3RDb25maWciLCJzZWFyY2giLCJkZWxheSIsImNvbnRyb2xsZXIiLCIkY3RybCIsInRoaXMiLCIkb25Jbml0IiwicmVzb2x2ZSIsInB1Ymxpc2hlciIsImZpbmFsbHkiLCJjYW5jZWwiLCJkaXNtaXNzIiwiZXh0ZW5kIiwibW9kYWxJbnN0YW5jZSIsImNsb3NlIiwiYmluZGluZ3MiLCJzZXJ2aWNlIiwiYXNNb2RhbCIsImFkZFN0YWZmVmlzaWJsZSIsImNyZWF0ZVN0YWZmIiwiJHVpYk1vZGFsIiwidGFibGVTdGF0ZVJlZiIsInBhZ2VTaXplRGVmYXVsdCIsInBhZ2UiLCJwYWdlU2l6ZSIsInRhYmxlU3RhdGUiLCJwcm9kdWN0cyIsInJlc3VsdHMiLCJwYWdlZCIsImVkaXQiLCJpdGVtIiwib3BlbiIsInNpemUiLCJyZXN1bHQiLCJyZWFzb24iLCJjcmVhdGUiLCJ1bnNoaWZ0IiwiaW5mbyIsInNob3dEZXRhaWxzIiwiZGlyZWN0aXZlIiwiJHRpbWVvdXQiLCIkcGFyc2UiLCJyZXF1aXJlIiwibGluayIsInNjb3BlIiwiZWxlbWVudCIsImF0dHIiLCJjdHJsIiwiYmluZCIsInRhYmxlQ3RybCIsInBpcGUiLCJyZXN0cmljdCIsImVsIiwiYXR0cnMiLCJvbiIsImV2ZW50Iiwid2hpY2giLCIkc2V0Vmlld1ZhbHVlIiwiJHJlbmRlciIsIiRhcHBseSIsImN0cmxzIiwibW9kZWwiLCJmb3JFYWNoIiwiJHZpZXdWYWx1ZSIsImtleSIsInRvTG93ZXJDYXNlIiwiQXJyYXkiLCJpc0FycmF5IiwiXyIsImluY2x1ZGVzIiwicHJlZGljYXRlT2JqZWN0IiwicGFnaW5hdGlvbiIsInN0YXJ0IiwibmdNb2RlbCIsInVuZGVmaW5lZCIsImNvbnRleHQiLCJhdHRyaWJ1dGVzIiwiZmllbGROYW1lIiwicHVibGlzaGVycyJdLCJtYXBwaW5ncyI6IkNBQ0EsV0FDcUJBLFFBQVFDLE9BQU8sc0JDRHBDLFdBQ0ksWUFHQSxTQUFTQyxHQUFrQkMsR0FRdkIsUUFBU0MsR0FBV0MsR0FDaEIsTUFBT0YsR0FBTUcsSUFBSSxlQUFpQkQsR0FBSUUsS0FBSyxTQUFVQyxHQUNqRCxNQUFPQSxHQUFFQyxPQUNWQyxNQUFNLFNBQVVDLEdBQ2ZDLFFBQVFDLElBQUlGLEVBQUlHLFdBSXhCLFFBQVNDLEdBQWVDLEdBQ3BCLE1BQU9iLEdBQU1HLElBQUksZUFBaUJXLE9BQVFELElBQWVULEtBQUssU0FBVUMsR0FDcEUsTUFBT0EsR0FBRUMsT0FDVkMsTUFBTSxTQUFVQyxHQUNmQyxRQUFR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bGUiOiJtb2R1bGVzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vc2VydmljZXMubW9kdWxlLmpzXHJcbihmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcC5zZXJ2aWNlcycsIFtdKTtcclxuICAgIH1cclxuKSgpOyIsIi8vcHJvZHVjdC5zZXJ2aWNlLmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcC5zZXJ2aWNlcycpLmZhY3RvcnkoJ1Byb2R1Y3RTZXJ2aWNlJywgc2VydmljZUNvbnRyb2xsZXIpO1xyXG5cclxuICAgIGZ1bmN0aW9uIHNlcnZpY2VDb250cm9sbGVyKCRodHRwKSB7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGdldFByb2R1Y3Q6IGdldFByb2R1Y3QsXHJcbiAgICAgICAgICAgIGdldEFsbFByb2R1Y3RzOiBnZXRBbGxQcm9kdWN0cyxcclxuICAgICAgICAgICAgc2F2ZTogc2F2ZVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldFByb2R1Y3QoaWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnYXBpL3Byb2R1Y3QvJyArIGlkKS50aGVuKGZ1bmN0aW9uIChyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gci5kYXRhO1xyXG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIubWVzc2FnZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0QWxsUHJvZHVjdHMoc2VhcmNoTW9kZWwpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnYXBpL3Byb2R1Y3QnLCB7IHBhcmFtczogc2VhcmNoTW9kZWwgfSkudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHIuZGF0YTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNhdmUocHJvZHVjdCkge1xyXG4gICAgICAgICAgICBpZiAocHJvZHVjdC5pZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICRodHRwLnB1dCgnYXBpL3Byb2R1Y3QnLCBwcm9kdWN0KS50aGVuKGZ1bmN0aW9uKHIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gci5kYXRhO1xyXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVyci5tZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnYXBpL3Byb2R1Y3QnLCBwcm9kdWN0KS50aGVuKGZ1bmN0aW9uIChyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHIuZGF0YTtcclxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXJyLm1lc3NhZ2U7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG59XHJcbikoKTsiLCIvL3Byb2R1Y3QtYXBwLm1vZHVsZS5qc1xyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnLFxyXG4gICAgW1xyXG4gICAgICAgICdhcHAuc2VydmljZXMnLFxyXG4gICAgICAgICdhcHAuZGlyZWN0aXZlcycsXHJcbiAgICAgICAgJ3NoYXJlZC5jb21wb25lbnRzJyxcclxuICAgICAgICAnbmdDb21wb25lbnRSb3V0ZXInLFxyXG4gICAgICAgICd1aS5ib290c3RyYXAnLFxyXG4gICAgICAgICdzbWFydC10YWJsZSdcclxuICAgIF0pO1xyXG5cclxuICAgIC8vbW9kdWxlLmNvbmZpZyhmdW5jdGlvbiAoKSB7Ly8kbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7IH0pO1xyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ2xpYnJhcnlBcHAnLFxyXG4gICAge1xyXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnL2FwcC9wcm9kdWN0LWFwcC5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgJHJvdXRlQ29uZmlnOiBbXHJcbiAgICAgICAgICAgIHsgcGF0aDogJy8nLCBuYW1lOiAnTGlzdCcsIGNvbXBvbmVudDogJ2xpc3QnLCB1c2VBc0RlZmF1bHQ6IHRydWUgfVxyXG4gICAgICAgIF1cclxuICAgIH0pO1xyXG5cclxuICAgIG1vZHVsZS52YWx1ZSgnJHJvdXRlclJvb3RDb21wb25lbnQnLCAnbGlicmFyeUFwcCcpO1xyXG5cclxuICAgIG1vZHVsZS5jb25maWcoZnVuY3Rpb24gKHN0Q29uZmlnKSB7XHJcbiAgICAgICAgc3RDb25maWcuc2VhcmNoLmRlbGF5ID0gMjAwMDtcclxuICAgIH0pO1xyXG5cclxufSkoKTsiLCIvL3B1Ymxpc2hlci1lZGl0LmNvbXBvbmVudC5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnKTtcclxuXHJcbiAgICBmdW5jdGlvbiBjb250cm9sbGVyKCRodHRwKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoJGN0cmwucmVzb2x2ZSkge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuaWQgPSAkY3RybC5yZXNvbHZlLmlkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICgkY3RybC5pZCkge1xyXG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KCdhcGkvcHVibGlzaGVyLycgKyAkY3RybC5pZCkudGhlbihmdW5jdGlvbihyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJGN0cmwucHVibGlzaGVyID0gci5kYXRhOyBcclxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciByZXRyaXZpbmcgcHVibGlzaGVyJywgZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgfSkuZmluYWxseShmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnJGN0cmwnLCAkY3RybCk7XHJcbiAgICAgICAgICAgIFxyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJGN0cmwuZGlzbWlzcygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuc2F2ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJ2FwaS9wdWJsaXNoZXInLCAkY3RybC5wdWJsaXNoZXIpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKCRjdHJsLnB1Ymxpc2hlciwgci5kYXRhKTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yIHNhdmluZyBwdWJsaXNoZXInLCBlcnIubWVzc2FnZSk7XHJcbiAgICAgICAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2VkaXQgcHVibGlzaGVyJywgJGN0cmwucHVibGlzaGVyKTtcclxuICAgICAgICAgICAgICAgICRjdHJsLm1vZGFsSW5zdGFuY2UuY2xvc2UoJGN0cmwucHVibGlzaGVyKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuY29tcG9uZW50KCdwdWJsaXNoZXJFZGl0JyxcclxuICAgIHtcclxuICAgICAgICBiaW5kaW5nczoge1xyXG4gICAgICAgICAgICBpZDogJzwnLCBcclxuICAgICAgICAgICAgcmVzb2x2ZTogJzwnLFxyXG4gICAgICAgICAgICBjbG9zZTogJyYnLFxyXG4gICAgICAgICAgICBkaXNtaXNzOiAnJicsXHJcbiAgICAgICAgICAgIG1vZGFsSW5zdGFuY2U6ICc8J1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvcHVibGlzaGVyL3B1Ymxpc2hlci1lZGl0LmNvbXBvbmVudC5odG1sJyxcclxuICAgICAgICBjb250cm9sbGVyOiBbJyRodHRwJywgY29udHJvbGxlcl1cclxuICAgIH0pO1xyXG5cclxufVxyXG4pKCk7IiwiLy9wcm9kdWN0LXN1bW1hcnkuY29tcG9uZW50LmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoc2VydmljZSkge1xyXG4gICAgICAgIHZhciAkY3RybCA9IHRoaXM7XHJcblxyXG4gICAgICAgICRjdHJsLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICgkY3RybC5yZXNvbHZlKSB7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5pZCA9ICRjdHJsLnJlc29sdmUuaWQ7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5hc01vZGFsID0gJGN0cmwucmVzb2x2ZS5hc01vZGFsO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuYWRkU3RhZmZWaXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHNlcnZpY2UuZ2V0UHJvZHVjdCgkY3RybC5pZCkudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwucHJvZHVjdCA9IHI7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuY3JlYXRlU3RhZmYgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2FkZCBzdGFmZiBtb2RhbCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkY3RybC5kaXNtaXNzKCk7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuY29tcG9uZW50KCdwcm9kdWN0U3VtbWFyeScsXHJcbiAgICB7XHJcbiAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgaWQ6ICc8JyxcclxuICAgICAgICAgICAgYXNNb2RhbDogJzwnLFxyXG4gICAgICAgICAgICByZXNvbHZlOiAnPCcsXHJcbiAgICAgICAgICAgIGNsb3NlOiAnJicsXHJcbiAgICAgICAgICAgIGRpc21pc3M6ICcmJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvcHJvZHVjdC9wcm9kdWN0LXN1bW1hcnkuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgICAgIGNvbnRyb2xsZXI6IFsnUHJvZHVjdFNlcnZpY2UnLCBjb250cm9sbGVyXVxyXG4gICAgfSk7XHJcblxyXG59XHJcbikoKTsiLCIvL3Byb2R1Y3QtbGlzdC5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoJHVpYk1vZGFsLCBzZXJ2aWNlKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuICAgICAgICB2YXIgcGFnZVNpemVEZWZhdWx0ID0gMTA7XHJcbiAgICAgICAgdmFyIHRhYmxlU3RhdGVSZWY7XHJcblxyXG4gICAgICAgICRjdHJsLnNlYXJjaE1vZGVsID0ge1xyXG4gICAgICAgICAgICBwYWdlOiAxLFxyXG4gICAgICAgICAgICBwYWdlU2l6ZTogcGFnZVNpemVEZWZhdWx0XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHt9XHJcblxyXG4gICAgICAgICRjdHJsLnNlYXJjaCA9IGZ1bmN0aW9uICh0YWJsZVN0YXRlKSB7XHJcbiAgICAgICAgICAgIHRhYmxlU3RhdGVSZWYgPSB0YWJsZVN0YXRlO1xyXG5cclxuICAgICAgICAgICAgc2VydmljZS5nZXRBbGxQcm9kdWN0cygkY3RybC5zZWFyY2hNb2RlbCkudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwucHJvZHVjdHMgPSByLnJlc3VsdHM7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5zZWFyY2hNb2RlbCA9IHI7XHJcbiAgICAgICAgICAgICAgICBkZWxldGUgJGN0cmwuc2VhcmNoTW9kZWwucmVzdWx0cztcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5wYWdlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJGN0cmwuc2VhcmNoKHRhYmxlU3RhdGVSZWYpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuZWRpdCA9IGZ1bmN0aW9uKGl0ZW0pIHtcclxuICAgICAgICAgICAgJHVpYk1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiAncHJvZHVjdEVkaXQnLFxyXG4gICAgICAgICAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlOiBcIjxcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBpZDogaXRlbS5pZFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNpemU6ICdsZydcclxuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoaXRlbSwgcmVzdWx0KTtcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmNyZWF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHVpYk1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiAncHJvZHVjdEVkaXQnLFxyXG4gICAgICAgICAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlOiBcIjxcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNpemU6ICdsZydcclxuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwucHJvZHVjdHMudW5zaGlmdChyZXN1bHQpO1xyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8oXCJJIHdhcyBkaW1pc3NlZCwgc28gZG8gd2hhdCBJIG5lZWQgdG8gZG8gbXlDb250ZW50J3MgY29udHJvbGxlciBub3cuICBSZWFzb24gd2FzLT5cIiArIHJlYXNvbik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuc2hvd0RldGFpbHMgPSBmdW5jdGlvbiAoaWQpIHtcclxuICAgICAgICAgICAgJHVpYk1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiAncHJvZHVjdFN1bW1hcnknLFxyXG4gICAgICAgICAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlOiBcIjxcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBpZDogaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYXNNb2RhbDogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNpemU6ICdsZydcclxuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5pbmZvKFwiSSB3YXMgY2xvc2VkLCBzbyBkbyB3aGF0IEkgbmVlZCB0byBkbyBteUNvbnRlbnQncyBjb250cm9sbGVyIG5vdy4gIFJlc3VsdCB3YXMtPlwiKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhyZXN1bHQpO1xyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8oXCJJIHdhcyBkaW1pc3NlZCwgc28gZG8gd2hhdCBJIG5lZWQgdG8gZG8gbXlDb250ZW50J3MgY29udHJvbGxlciBub3cuICBSZWFzb24gd2FzLT5cIiArIHJlYXNvbik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW9kdWxlLmNvbXBvbmVudCgnbGlzdCcsXHJcbiAgICB7XHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvcHJvZHVjdC9wcm9kdWN0LWxpc3QuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgICAgIGNvbnRyb2xsZXI6IFsnJHVpYk1vZGFsJywgJ1Byb2R1Y3RTZXJ2aWNlJywgY29udHJvbGxlcl1cclxuICAgIH0pO1xyXG5cclxufVxyXG4pKCk7IiwiLy9wcm9kdWN0LWVkaXQuY29tcG9uZW50LmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoc2VydmljZSkge1xyXG4gICAgICAgIHZhciAkY3RybCA9IHRoaXM7XHJcblxyXG4gICAgICAgICRjdHJsLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICgkY3RybC5yZXNvbHZlKSB7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5pZCA9ICRjdHJsLnJlc29sdmUuaWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCRjdHJsLmlkKSB7XHJcbiAgICAgICAgICAgICAgICBzZXJ2aWNlLmdldFByb2R1Y3QoJGN0cmwuaWQpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgICAgICAkY3RybC5wcm9kdWN0ID0gcjtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRjdHJsLmRpc21pc3MoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnNhdmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzZXJ2aWNlLnNhdmUoJGN0cmwucHJvZHVjdCkudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoJGN0cmwucHJvZHVjdCwgcik7XHJcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBzYXZpbmcgcHJvZHVjdCcsIGVyci5tZXNzYWdlKTtcclxuICAgICAgICAgICAgfSkuZmluYWxseShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5tb2RhbEluc3RhbmNlLmNsb3NlKCRjdHJsLnByb2R1Y3QpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3Byb2R1Y3RFZGl0JyxcclxuICAgIHtcclxuICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9wcm9kdWN0L3Byb2R1Y3QtZWRpdC5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgaWQ6ICc8JyxcclxuICAgICAgICAgICAgcmVzb2x2ZTogJzwnLFxyXG4gICAgICAgICAgICBjbG9zZTogJyYnLFxyXG4gICAgICAgICAgICBkaXNtaXNzOiAnJicsXHJcbiAgICAgICAgICAgIG1vZGFsSW5zdGFuY2U6ICc8J1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY29udHJvbGxlcjogWydQcm9kdWN0U2VydmljZScsIGNvbnRyb2xsZXJdXHJcbiAgICB9KTtcclxufSkoKTtcclxuICAgICIsIi8vZGlyZWN0aXZlcy5tb2R1bGVzLmpzXHJcbihmdW5jdGlvbigpIHtcclxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAuZGlyZWN0aXZlcycsIFtdKTsgXHJcbn0pKCk7IiwiLy9zdFRhYmxlLmRpcmVjdGl2ZS5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwLmRpcmVjdGl2ZXMnKTtcclxuXHJcbiAgICBtb2R1bGUuZGlyZWN0aXZlKCdzdFN1Ym1pdFNlYXJjaCcsIFsnc3RDb25maWcnLCAnJHRpbWVvdXQnLCAnJHBhcnNlJywgZnVuY3Rpb24gKHN0Q29uZmlnLCAkdGltZW91dCwgJHBhcnNlKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVxdWlyZTogJ15zdFRhYmxlJyxcclxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudC5iaW5kKCdjbGljaycsXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc2VhcmNoJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YWJsZUN0cmwgPSBjdHJsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwucGlwZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XSk7XHJcblxyXG4gICAgbW9kdWxlLmRpcmVjdGl2ZShcImNsZWFyS2V5XCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZXN0cmljdDogJ0VBJyxcclxuICAgICAgICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxyXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsLCBhdHRycywgY3RybCkge1xyXG4gICAgICAgICAgICAgICAgZWwub24oJ2tleWRvd24nLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQud2hpY2ggIT09IDI3KSB7IHJldHVybjsgfSAvLyBjaGVjayBrZXkgaG93IHlvdSB3YW50XHJcbiAgICAgICAgICAgICAgICAgICAgY3RybC4kc2V0Vmlld1ZhbHVlKG51bGwpO1xyXG4gICAgICAgICAgICAgICAgICAgIGN0cmwuJHJlbmRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseSgpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcblxyXG5cclxuICAgIG1vZHVsZS5kaXJlY3RpdmUoXCJzdFJlc2V0U2VhcmNoXCIsXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdHJpY3Q6ICdFQScsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZTogWydec3RUYWJsZScsICdebmdNb2RlbCddLFxyXG4gICAgICAgICAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMsIGN0cmxzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50LmJpbmQoJ2NsaWNrJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kZWwgPSBjdHJsc1sxXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3RybCA9IGN0cmxzWzBdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKG1vZGVsLiR2aWV3VmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAodmFsdWUsIGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZXkudG9Mb3dlckNhc2UoKSA9PT0gJ3BhZ2UnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLiR2aWV3VmFsdWVba2V5XSA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSB8fCBfLmluY2x1ZGVzKGtleS50b0xvd2VyQ2FzZSgpLCAncGFnZScpKSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuJHZpZXdWYWx1ZVtrZXldID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFibGVTdGF0ZSA9IGN0cmwudGFibGVTdGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZVN0YXRlLnNlYXJjaC5wcmVkaWNhdGVPYmplY3QgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVTdGF0ZS5wYWdpbmF0aW9uLnN0YXJ0ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGN0cmwucGlwZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgbW9kdWxlLmRpcmVjdGl2ZShcInN0Q2xlYXJLZXlcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRUEnLFxyXG4gICAgICAgICAgICByZXF1aXJlOiBbJ15zdFRhYmxlJywgJ15uZ01vZGVsJ10sXHJcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMsIGN0cmxzKSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50Lm9uKCdrZXlkb3duJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5nTW9kZWwgPSBjdHJsc1sxXTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY3RybCA9IGN0cmxzWzBdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQud2hpY2ggPT09IDEzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjdHJsLnBpcGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LndoaWNoID09PSAyNykge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuY29udGV4dC5hdHRyaWJ1dGVzWydzdC1zZWFyY2gnXSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmllbGROYW1lID0gZWxlbWVudC5jb250ZXh0LmF0dHJpYnV0ZXNbJ3N0LXNlYXJjaCddLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YWJsZVN0YXRlID0gY3RybC50YWJsZVN0YXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVTdGF0ZS5zZWFyY2gucHJlZGljYXRlT2JqZWN0W2ZpZWxkTmFtZV0gPSAnJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3RybC5waXBlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZ01vZGVsLiRzZXRWaWV3VmFsdWUobnVsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmdNb2RlbC4kcmVuZGVyKCk7IC8vIHdpbGwgdXBkYXRlIHRoZSBpbnB1dCB2YWx1ZSBhcyB3ZWxsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9KTtcclxuXHJcbn1cclxuKSgpOyIsIi8vc2hhcmVkLWNvbXBvbmVudHMubW9kdWxlLmpzXHJcbihmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ3NoYXJlZC5jb21wb25lbnRzJywgW10pO1xyXG4gICAgfVxyXG4pKCk7IiwiLy9wdWJsaXNoZXItbGlzdC5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ3NoYXJlZC5jb21wb25lbnRzJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcigkaHR0cCwgJHVpYk1vZGFsKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJGh0dHAuZ2V0KCdhcGkvcHVibGlzaGVyJykudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwucHVibGlzaGVycyA9IHIuZGF0YTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmNyZWF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHVpYk1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiAncHVibGlzaGVyRWRpdCcsXHJcbiAgICAgICAgICAgICAgICBiaW5kaW5nczoge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2U6IFwiPFwiXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogJ2xnJ1xyXG4gICAgICAgICAgICB9KS5yZXN1bHQudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8oXCJJIHdhcyBjbG9zZWQsIHNvIGRvIHdoYXQgSSBuZWVkIHRvIGRvIG15Q29udGVudCdzIGNvbnRyb2xsZXIgbm93LiAgUmVzdWx0IHdhcy0+XCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5pbmZvKCdyZXR1cm5pbmcgcmVzdWx0JywgcmVzdWx0KTtcclxuICAgICAgICAgICAgICAgICRjdHJsLnB1Ymxpc2hlcnMudW5zaGlmdChyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuaWQgPSByZXN1bHQuaWQ7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhcIkkgd2FzIGRpbWlzc2VkLCBzbyBkbyB3aGF0IEkgbmVlZCB0byBkbyBteUNvbnRlbnQncyBjb250cm9sbGVyIG5vdy4gIFJlYXNvbiB3YXMtPlwiICsgcmVhc29uKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5lZGl0ID0gZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgJHVpYk1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiAncHVibGlzaGVyRWRpdCcsXHJcbiAgICAgICAgICAgICAgICBiaW5kaW5nczoge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2U6IFwiPFwiXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiAkY3RybC5pZFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNpemU6ICdsZydcclxuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKCRjdHJsLnB1Ymxpc2hlcnMsIGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uaWQgPT09ICRjdHJsLmlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKGl0ZW0sIHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRjdHJsLmlkID0gaXRlbS5pZDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhcIkkgd2FzIGRpbWlzc2VkLCBzbyBkbyB3aGF0IEkgbmVlZCB0byBkbyBteUNvbnRlbnQncyBjb250cm9sbGVyIG5vdy4gIFJlYXNvbiB3YXMtPlwiICsgcmVhc29uKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3B1Ymxpc2hlckxpc3QnLFxyXG4gICAge1xyXG4gICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgIGlkOiAnPSdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2NvbW1vbi9wdWJsaXNoZXItbGlzdC5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgY29udHJvbGxlcjogWyckaHR0cCcsICckdWliTW9kYWwnLCBjb250cm9sbGVyXVxyXG4gICAgfSk7XHJcblxyXG5cclxufVxyXG4pKCk7Il19
