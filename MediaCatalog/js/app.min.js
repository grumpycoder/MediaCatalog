!function(){"use strict";var e=angular.module("app",["AdalAngular","ngStorage","app.directives","shared.components","ui.bootstrap","smart-table","cp.ngConfirm"]).config(["$httpProvider","adalAuthenticationServiceProvider",function(e,r){r.init({tenant:"ffb63644-2219-46e0-9edd-cad35ce33520",clientId:"01951663-dec1-4a5b-b4b5-1cef72f610e5",extraQueryParameter:"nux=1",cacheLocation:"localStorage"},e)}]);e.factory("AuthenticationInterceptor",["$localStorage","$window",function(e,r){var t=this;return t.request=function(r){return r.headers=r.headers||{},e.currentUser&&(r.headers.Authorization="Bearer "+e.currentUser.token),r},t.responseError=function(e){return console.log("response error",e),401!==e.status&&403!==e.status||(r.location="/account/login"),$q.reject(e)},t}])}();
!function(){angular.module("shared.components",[])}();
!function(){function n(){var n=this;n.$onInit=function(){console.log("modal",n)}}var o=angular.module("app");o.component("confirmationModal",{bindings:{},template:"yes or no",controller:[n]})}();
!function(){function n(n,o){var e=this;e.$onInit=function(){n.get("api/publisher").then(function(n){e.publishers=n.data}).catch(function(n){console.log(n.message)})},e.create=function(){o.open({component:"publisherEdit",bindings:{modalInstance:"<"},size:"lg"}).result.then(function(n){console.info("I was closed, so do what I need to do myContent's controller now.  Result was->"),console.info("returning result",n),e.publishers.unshift(n),e.id=n.id},function(n){console.info("I was dimissed, so do what I need to do myContent's controller now.  Reason was->"+n)})},e.edit=function(){o.open({component:"publisherEdit",bindings:{modalInstance:"<"},resolve:{id:e.id},size:"lg"}).result.then(function(n){angular.forEach(e.publishers,function(o){o.id===e.id&&(angular.extend(o,n),e.id=o.id)})},function(n){console.info("I was dimissed, so do what I need to do myContent's controller now.  Reason was->"+n)})}}var o=angular.module("shared.components");o.component("publisherSelect",{bindings:{id:"="},templateUrl:"app/common/publisher-select.component.html",controller:["$http","$uibModal",n]})}();
!function(){angular.module("app.directives",[])}();
!function(){var e=angular.module("app.directives");e.directive("stSubmitSearch",["stConfig","$timeout","$parse",function(e,t,r){return{require:"^stTable",link:function(e,t,r,n){return t.bind("click",function(){var e=n;e.pipe()})}}}]),e.directive("clearKey",function(){return{restrict:"EA",require:"ngModel",link:function(e,t,r,n){t.on("keydown",function(t){27===t.which&&(n.$setViewValue(null),n.$render(),e.$apply())})}}}),e.directive("stResetSearch",function(){return{restrict:"EA",require:["^stTable","^ngModel"],link:function(e,t,r,n){return t.bind("click",function(){var t=n[1],r=n[0];return e.$apply(function(){angular.forEach(t.$viewValue,function(e,r){"page"===r.toLowerCase()&&(t.$viewValue[r]=1),Array.isArray(e)||_.includes(r.toLowerCase(),"page")||(t.$viewValue[r]=null)});var e=r.tableState();return e.search.predicateObject={},e.pagination.start=0,r.pipe()})})}}}),e.directive("stClearKey",function(){return{restrict:"EA",require:["^stTable","^ngModel"],link:function(e,t,r,n){t.on("keydown",function(r){var i=n[1],a=n[0];return 13===r.which?a.pipe():27===r.which?void 0!==t.context.attributes["st-search"]?e.$apply(function(){var e=t.context.attributes["st-search"].value,r=a.tableState();return r.search.predicateObject[e]="",a.pipe()}):e.$apply(function(){i.$setViewValue(null),i.$render()}):void 0})}}})}();
!function(){function t(t){var n=this;n.$onInit=function(){n.title="New Product",n.resolve&&(n.id=n.resolve.id),n.id&&t.getProduct(n.id).then(function(t){n.product=t,n.title=t.title})},n.cancel=function(){n.dismiss()},n.save=function(){return t.save(n.product).then(function(t){angular.extend(n.product,t),n.modalInstance.close(n.product)}).catch(function(t){console.log("Error saving product",t.message)}).finally(function(){})}}var n=angular.module("app");n.component("productEdit",{templateUrl:"app/product/product-edit.component.html",bindings:{id:"<",resolve:"<",close:"&",dismiss:"&",modalInstance:"<"},controller:["Product",t]})}();
!function(){"use strict";function n(n,o,t,e,s){var i,c=this,d=10;c.searchModel={page:1,pageSize:d},c.$onInit=function(){console.log("product list init"),c.title="Product List",e.getToken()},c.search=function(n){i=n,console.log("search"),t.getAllProducts(c.searchModel).then(function(n){c.products=n.results,c.searchModel=n,delete c.searchModel.results})},c.paged=function(){c.search(i)},c.create=function(){n.open({component:"productEdit",bindings:{modalInstance:"<"},size:"md"}).result.then(function(n){c.products.unshift(n)},function(n){console.info("I was dimissed, so do what I need to do myContent's controller now.  Reason was->"+n)})},c.edit=function(o){n.open({component:"productEdit",bindings:{modalInstance:"<"},resolve:{id:o.id},size:"md"}).result.then(function(n){angular.extend(o,n)},function(n){})},c.delete=function(n){o({title:"Delete",content:"Are you sure you want to delete <br /><strong>"+n.title+"</strong>?",type:"red",buttons:{yes:{keys:["y"],action:function(o,e){t.remove(n.id).then(function(o){var t=c.products.indexOf(n);c.products.splice(t,1)})}},no:{keys:["N"],action:function(n,o){}}}})},c.showDetails=function(o){n.open({component:"productSummary",bindings:{modalInstance:"<"},resolve:{id:o.id,asModal:!0},size:"md"}).result.then(function(n){console.info("I was closed, so do what I need to do myContent's controller now.  Result was->"),angular.extend(o,n)},function(n){console.info("I was dimissed, so do what I need to do myContent's controller now.  Reason was->"+n)})}}var o=angular.module("app");o.component("productList",{templateUrl:"app/product/product-list.component.html",controller:["$uibModal","$ngConfirm","Product","User","adalAuthenticationService",n]})}();
!function(){function o(o,n){var t=this;t.$onInit=function(){t.resolve&&(t.id=t.resolve.id,t.asModal=t.resolve.asModal,t.addStaffVisible=!1),n.getProduct(t.id).then(function(o){t.product=o})},t.edit=function(){o.open({component:"productEdit",bindings:{modalInstance:"<"},resolve:{id:t.product.id},size:"md"}).result.then(function(o){angular.extend(t.product,o)},function(o){})},t.showNewStaff=function(){o.open({component:"staffEdit",bindings:{modalInstance:"<"},resolve:{productId:t.id},size:"md"}).result.then(function(o){console.info("I was closed, so do what I need to do myContent's controller now.  Result was->"),t.product.staff.unshift(o)},function(o){console.info("I was dimissed, so do what I need to do myContent's controller now.  Reason was->"+o)})},t.cancel=function(){t.modalInstance.close(t.product)}}var n=angular.module("app");n.component("productSummary",{bindings:{id:"<",asModal:"<",resolve:"<",close:"&",dismiss:"&",modalInstance:"<"},templateUrl:"app/product/product-summary.component.html",controller:["$uibModal","Product",o]})}();
!function(){function t(t,r){function e(){if(r.currentUser){var e=r.currentUser;t.post("api/auth/authenticate?user="+e.user+"&password="+e.password).then(function(t){e.token=t.data,r.currentUser=e}).catch(function(t){})}}return{getToken:e}}var r=angular.module("app");r.service("User",["$http","$localStorage",t])}();
!function(){"use strict";function t(t){function n(n){return t.get("api/product/"+n).then(function(t){return t.data}).catch(function(t){console.log(t.message)})}function e(n){return t.get("api/product",{params:n}).then(function(t){return t.data}).catch(function(t){console.log(t.message)})}function u(n){return t.delete("api/product/"+n).then(function(t){return t.data}).catch(function(t){console.log(t.message)})}function c(n){return n.id?t.put("api/product",n).then(function(t){return t.data}).catch(function(t){return t.message}):t.post("api/product",n).then(function(t){return t.data}).catch(function(t){return t.message})}return{getProduct:n,getAllProducts:e,remove:u,save:c}}var n=angular.module("app");n.factory("Product",["$http",t])}();
!function(){function t(t){var a=this;a.$onInit=function(){console.log("staff edit init"),a.title="New Staff",a.resolve&&(a.productId=a.resolve.productId),a.resolve.staff&&(a.staff=a.resolve.staff,a.title=a.staff.firstname+" "+a.staff.lastname)},a.cancel=function(){a.dismiss()},a.save=function(){a.productId?t.post("api/staff/"+a.productId,a.staff).then(function(t){angular.extend(a.staff,t.data),a.modalInstance.close(t.data)}).catch(function(t){console.log("something went wrong",t.message)}):t.post("api/staff",a.staff).then(function(t){angular.extend(a.staff,t.data),a.modalInstance.close(t.data)}).catch(function(t){console.log("something went wrong",t.message)})}}var a=angular.module("app");a.component("staffEdit",{bindings:{resolve:"<",close:"&",dismiss:"&",staff:"<",productId:"<",modalInstance:"<"},templateUrl:"app/staff/staff-edit.component.html",controller:["$http",t]})}();
!function(){function t(t,n,o){var e=this;e.$onInit=function(){console.log("staff list init")},e.edit=function(t){n.open({component:"staffEdit",bindings:{modalInstance:"<",staff:t},resolve:{staff:t},size:"md"}).result.then(function(t){console.info("I was closed, so do what I need to do myContent's controller now.  Result was->")},function(t){console.info("I was dimissed, so do what I need to do myContent's controller now.  Reason was->"+t)})},e.delete=function(n){o({title:"Delete",content:"Are you sure you want to delete <br /><strong>"+n.firstname+n.lastname+"</strong>?",type:"red",buttons:{yes:{keys:["y"],action:function(o,s){t.delete("api/staff/"+n.id).then(function(t){var o=e.staff.indexOf(n);e.staff.splice(o,1)}).catch(function(t){console.log("error",t.message)})}},no:{keys:["N"],action:function(t,n){}}}})}}var n=angular.module("app");n.component("staffList",{bindings:{staff:"<"},templateUrl:"app/staff/staff-list.component.html",controller:["$http","$uibModal","$ngConfirm",t]})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJjb21tb24vY29tcG9uZW50cy5tb2R1bGUuanMiLCJjb21tb24vY29uZnJtYXRpb24tbW9kYWwuY29tcG9uZW50LmpzIiwiY29tbW9uL3B1Ymxpc2hlci1zZWxlY3QuY29tcG9uZW50LmpzIiwiZGlyZWN0aXZlcy9kaXJlY3RpdmVzLm1vZHVsZXMuanMiLCJkaXJlY3RpdmVzL3N0VGFibGUuZGlyZWN0aXZlLmpzIiwicHJvZHVjdC9wcm9kdWN0LWVkaXQuY29tcG9uZW50LmpzIiwicHJvZHVjdC9wcm9kdWN0LWxpc3QuY29tcG9uZW50LmpzIiwicHJvZHVjdC9wcm9kdWN0LXN1bW1hcnkuY29tcG9uZW50LmpzIiwic2VydmljZXMvYXV0aC5zZXJ2aWNlLmpzIiwic2VydmljZXMvcHJvZHVjdC5zZXJ2aWNlLmpzIiwic3RhZmYvc3RhZmYtZWRpdC5jb21wb25lbnQuanMiLCJzdGFmZi9zdGFmZi1saXN0LmNvbXBvbmVudC5qcyJdLCJuYW1lcyI6WyJtb2R1bGUiLCJhbmd1bGFyIiwiY29uZmlnIiwiJGh0dHBQcm92aWRlciIsImFkYWxQcm92aWRlciIsImluaXQiLCJ0ZW5hbnQiLCJjbGllbnRJZCIsImV4dHJhUXVlcnlQYXJhbWV0ZXIiLCJjYWNoZUxvY2F0aW9uIiwiZmFjdG9yeSIsIiRsb2NhbFN0b3JhZ2UiLCIkd2luZG93Iiwic2VydmljZSIsInRoaXMiLCJyZXF1ZXN0IiwiaGVhZGVycyIsImN1cnJlbnRVc2VyIiwiQXV0aG9yaXphdGlvbiIsInRva2VuIiwicmVzcG9uc2VFcnJvciIsInJlc3BvbnNlIiwiY29uc29sZSIsImxvZyIsInN0YXR1cyIsImxvY2F0aW9uIiwiJHEiLCJyZWplY3QiLCJjb250cm9sbGVyIiwiJGN0cmwiLCIkb25Jbml0IiwiY29tcG9uZW50IiwiYmluZGluZ3MiLCJ0ZW1wbGF0ZSIsIiRodHRwIiwiJHVpYk1vZGFsIiwiZ2V0IiwidGhlbiIsInIiLCJwdWJsaXNoZXJzIiwiZGF0YSIsImNhdGNoIiwiZXJyIiwibWVzc2FnZSIsImNyZWF0ZSIsIm9wZW4iLCJtb2RhbEluc3RhbmNlIiwic2l6ZSIsInJlc3VsdCIsImluZm8iLCJ1bnNoaWZ0IiwiaWQiLCJyZWFzb24iLCJlZGl0IiwicmVzb2x2ZSIsImZvckVhY2giLCJpdGVtIiwiZXh0ZW5kIiwidGVtcGxhdGVVcmwiLCJkaXJlY3RpdmUiLCJzdENvbmZpZyIsIiR0aW1lb3V0IiwiJHBhcnNlIiwicmVxdWlyZSIsImxpbmsiLCJzY29wZSIsImVsZW1lbnQiLCJhdHRyIiwiY3RybCIsImJpbmQiLCJ0YWJsZUN0cmwiLCJwaXBlIiwicmVzdHJpY3QiLCJlbCIsImF0dHJzIiwib24iLCJldmVudCIsIndoaWNoIiwiJHNldFZpZXdWYWx1ZSIsIiRyZW5kZXIiLCIkYXBwbHkiLCJjdHJscyIsIm1vZGVsIiwiJHZpZXdWYWx1ZSIsInZhbHVlIiwia2V5IiwidG9Mb3dlckNhc2UiLCJBcnJheSIsImlzQXJyYXkiLCJfIiwiaW5jbHVkZXMiLCJ0YWJsZVN0YXRlIiwic2VhcmNoIiwicHJlZGljYXRlT2JqZWN0IiwicGFnaW5hdGlvbiIsInN0YXJ0IiwibmdNb2RlbCIsInVuZGVmaW5lZCIsImNvbnRleHQiLCJhdHRyaWJ1dGVzIiwiZmllbGROYW1lIiwidGl0bGUiLCJnZXRQcm9kdWN0IiwicHJvZHVjdCIsImNhbmNlbCIsImRpc21pc3MiLCJzYXZlIiwiY2xvc2UiLCJmaW5hbGx5IiwiJG1vZGFsIiwiJG5nQ29uZmlybSIsInVzZXIiLCJhZGFsU2VydmljZSIsInRhYmxlU3RhdGVSZWYiLCJwYWdlU2l6ZURlZmF1bHQiLCJzZWFyY2hNb2RlbCIsInBhZ2UiLCJwYWdlU2l6ZSIsImdldFRva2VuIiwiZ2V0QWxsUHJvZHVjdHMiLCJwcm9kdWN0cyIsInJlc3VsdHMiLCJwYWdlZCIsImRlbGV0ZSIsImNvbnRlbnQiLCJ0eXBlIiwiYnV0dG9ucyIsInllcyIsImtleXMiLCJhY3Rpb24iLCJidXR0b24iLCJyZW1vdmUiLCJpZHgiLCJpbmRleE9mIiwic3BsaWNlIiwibm8iLCJzaG93RGV0YWlscyIsImFzTW9kYWwiLCJhZGRTdGFmZlZpc2libGUiLCJzaG93TmV3U3RhZmYiLCJwcm9kdWN0SWQiLCJzdGFmZiIsInBvc3QiLCJwYXNzd29yZCIsInNlcnZpY2VDb250cm9sbGVyIiwicGFyYW1zIiwicHV0IiwiZmlyc3RuYW1lIiwibGFzdG5hbWUiLCJtZW1iZXIiXSwibWFwcGluZ3MiOiJDQUNBLFdBQ0ksWUFFQSxJQUFJQSxHQUFTQyxRQUFRRCxPQUFPLE9BRXBCLGNBQ0EsWUFDQSxpQkFDQSxvQkFDQSxlQUNBLGNBQ0EsaUJBQ0RFLFFBQVEsZ0JBQWlCLG9DQUV4QixTQUFVQyxFQUFlQyxHQVVyQkEsRUFBYUMsTUFHTEMsT0FBUSx1Q0FDUkMsU0FBVSx1Q0FDVkMsb0JBQXFCLFFBRXJCQyxjQUFlLGdCQUduQk4sS0FPaEJILEdBQU9VLFFBQVEsNkJBQ1YsZ0JBQWlCLFVBQVcsU0FBVUMsRUFBZUMsR0FFbEQsR0FBSUMsR0FBVUMsSUFpQmQsT0FoQkFELEdBQVFFLFFBQVUsU0FBVWIsR0FLeEIsTUFKQUEsR0FBT2MsUUFBVWQsRUFBT2MsWUFDcEJMLEVBQWNNLGNBQ2RmLEVBQU9jLFFBQVFFLGNBQWdCLFVBQVlQLEVBQWNNLFlBQVlFLE9BRWxFakIsR0FHWFcsRUFBUU8sY0FBZ0IsU0FBVUMsR0FLOUIsTUFKQUMsU0FBUUMsSUFBSSxpQkFBa0JGLEdBQ04sTUFBcEJBLEVBQVNHLFFBQXNDLE1BQXBCSCxFQUFTRyxTQUNwQ1osRUFBUWEsU0FBVyxrQkFFaEJDLEdBQUdDLE9BQU9OLElBR2RSO0NDN0RuQixXQUNxQlosUUFBUUQsT0FBTztDQ0RwQyxXQUdJLFFBQVM0QixLQUNMLEdBQUlDLEdBQVFmLElBRVplLEdBQU1DLFFBQVUsV0FDWlIsUUFBUUMsSUFBSSxRQUFTTSxJQU43QixHQUFJN0IsR0FBU0MsUUFBUUQsT0FBTyxNQVc1QkEsR0FBTytCLFVBQVUscUJBRVRDLFlBRUFDLFNBQVUsWUFDVkwsWUFBYUE7Q0NqQnpCLFdBSUksUUFBU0EsR0FBV00sRUFBT0Ms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UyxpREFBbUR5QixFQUFPRixVQUFZRSxFQUFPRCxTQUFXLGFBQ2pHdkIsS0FBTSxNQUNOQyxTQUNJQyxLQUNJQyxNQUFPLEtBQ1BDLE9BQVEsU0FBVWhFLEVBQU9pRSxHQUNyQmhHLEVBQU15RixPQUFPLGFBQWUwQixFQUFPbEcsSUFBSWQsS0FBSyxTQUFVQyxHQUNsRCxHQUFJOEYsR0FBTXZHLEVBQU1nSCxNQUFNUixRQUFRZ0IsRUFDOUJ4SCxHQUFNZ0gsTUFBTVAsT0FBT0YsRUFBSyxLQUN6QjNGLE1BQU0sU0FBVUMsR0FDZnBCLFFBQVFDLElBQUksUUFBU21CLEVBQUlDLGFBSXJDNEYsSUFDSVAsTUFBTyxLQUNQQyxPQUFRLFNBQVVoRSxFQUFPaUUsVUEvQzdDLEdBQUlsSSxHQUFTQyxRQUFRRCxPQUFPLE1BeUQ1QkEsR0FBTytCLFVBQVUsYUFFVEMsVUFDSTZHLE1BQU8sS0FFWG5GLFlBQWEsc0NBQ2I5QixZQUFhLFFBQVMsWUFBYSxhQUFjQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy9hcHAubW9kdWxlLmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnLFxyXG4gICAgICAgIFtcclxuICAgICAgICAgICAgJ0FkYWxBbmd1bGFyJyxcclxuICAgICAgICAgICAgJ25nU3RvcmFnZScsXHJcbiAgICAgICAgICAgICdhcHAuZGlyZWN0aXZlcycsXHJcbiAgICAgICAgICAgICdzaGFyZWQuY29tcG9uZW50cycsXHJcbiAgICAgICAgICAgICd1aS5ib290c3RyYXAnLFxyXG4gICAgICAgICAgICAnc21hcnQtdGFibGUnLFxyXG4gICAgICAgICAgICAnY3AubmdDb25maXJtJ1xyXG4gICAgICAgIF0pLmNvbmZpZyhbJyRodHRwUHJvdmlkZXInLCAnYWRhbEF1dGhlbnRpY2F0aW9uU2VydmljZVByb3ZpZGVyJyxcclxuICAgICAgICAgICAgLy9mdW5jdGlvbiAoJGxvY2FsU3RvcmFnZVByb3ZpZGVyLCAkaHR0cFByb3ZpZGVyLCBhZGFsUHJvdmlkZXIpIHtcclxuICAgICAgICAgICAgZnVuY3Rpb24gKCRodHRwUHJvdmlkZXIsIGFkYWxQcm92aWRlcikge1xyXG4gICAgICAgICAgICAgICAgLy8kbG9jYWxTdG9yYWdlUHJvdmlkZXIuc2V0S2V5UHJlZml4KCdtYy0nKTtcclxuICAgICAgICAgICAgICAgIC8vJGh0dHBQcm92aWRlci5pbnRlcmNlcHRvcnMucHVzaCgnQXV0aGVudGljYXRpb25JbnRlcmNlcHRvcicpO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBlbmRwb2ludHMgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJodHRwczovL2xvY2FsaG9zdDo0NDM2Mi9hcGlcIjogXCIwMTk1MTY2My1kZWMxLTRhNWItYjRiNS0xY2VmNzJmNjEwZTVcIlxyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAvL3ZhciBlbmRwb2ludHMgPSB7fVxyXG5cclxuICAgICAgICAgICAgICAgIGFkYWxQcm92aWRlci5pbml0KFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9pbnN0YW5jZTogJ2h0dHBzOi8vbG9naW4ubWljcm9zb2Z0b25saW5lLmNvbS8nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW5hbnQ6ICdmZmI2MzY0NC0yMjE5LTQ2ZTAtOWVkZC1jYWQzNWNlMzM1MjAnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRJZDogJzAxOTUxNjYzLWRlYzEtNGE1Yi1iNGI1LTFjZWY3MmY2MTBlNScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhUXVlcnlQYXJhbWV0ZXI6ICdudXg9MScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vZW5kcG9pbnRzOiBlbmRwb2ludHNcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGVMb2NhdGlvbjogJ2xvY2FsU3RvcmFnZScsIC8vIGVuYWJsZSB0aGlzIGZvciBJRSwgYXMgc2Vzc2lvblN0b3JhZ2UgZG9lcyBub3Qgd29yayBmb3IgbG9jYWxob3N0LiAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFsc28sIHRva2VuIGFjcXVpc2l0aW9uIGZvciB0aGUgVG8gR28gQVBJIHdpbGwgZmFpbCBpbiBJRSB3aGVuIHJ1bm5pbmcgb24gbG9jYWxob3N0LCBkdWUgdG8gSUUgc2VjdXJpdHkgcmVzdHJpY3Rpb25zLlxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgJGh0dHBQcm92aWRlclxyXG4gICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdKTtcclxuXHJcblxyXG4gICAgbW9kdWxlLmZhY3RvcnkoJ0F1dGhlbnRpY2F0aW9uSW50ZXJjZXB0b3InLFxyXG4gICAgICAgIFsnJGxvY2FsU3RvcmFnZScsICckd2luZG93JywgZnVuY3Rpb24gKCRsb2NhbFN0b3JhZ2UsICR3aW5kb3cpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciBzZXJ2aWNlID0gdGhpcztcclxuICAgICAgICAgICAgc2VydmljZS5yZXF1ZXN0ID0gZnVuY3Rpb24gKGNvbmZpZykge1xyXG4gICAgICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMgPSBjb25maWcuaGVhZGVycyB8fCB7fTtcclxuICAgICAgICAgICAgICAgIGlmICgkbG9jYWxTdG9yYWdlLmN1cnJlbnRVc2VyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9ICdCZWFyZXIgJyArICRsb2NhbFN0b3JhZ2UuY3VycmVudFVzZXIudG9rZW47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uZmlnO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgc2VydmljZS5yZXNwb25zZUVycm9yID0gZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncmVzcG9uc2UgZXJyb3InLCByZXNwb25zZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEgfHwgcmVzcG9uc2Uuc3RhdHVzID09PSA0MDMpIHtcclxuICAgICAgICAgICAgICAgICAgICAkd2luZG93LmxvY2F0aW9uID0gJy9hY2NvdW50L2xvZ2luJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiAkcS5yZWplY3QocmVzcG9uc2UpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHNlcnZpY2U7XHJcbiAgICAgICAgfV0pO1xyXG5cclxufSkoKTsiLCIvL3NoYXJlZC1jb21wb25lbnRzLm1vZHVsZS5qc1xyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdzaGFyZWQuY29tcG9uZW50cycsIFtdKTtcclxuICAgIH1cclxuKSgpOyIsIi8vY29uZnJtYXRpb24tbW9kYWwuY29tcG9uZW50LmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpczsgXHJcblxyXG4gICAgICAgICRjdHJsLiRvbkluaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ21vZGFsJywgJGN0cmwpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW9kdWxlLmNvbXBvbmVudCgnY29uZmlybWF0aW9uTW9kYWwnLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdGVtcGxhdGU6ICd5ZXMgb3Igbm8nLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiBbY29udHJvbGxlcl1cclxuICAgICAgICB9KTtcclxufVxyXG4pKCk7IiwiLy9wdWJsaXNoZXItbGlzdC5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ3NoYXJlZC5jb21wb25lbnRzJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcigkaHR0cCwgJHVpYk1vZGFsKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJGh0dHAuZ2V0KCdhcGkvcHVibGlzaGVyJykudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwucHVibGlzaGVycyA9IHIuZGF0YTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmNyZWF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHVpYk1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiAncHVibGlzaGVyRWRpdCcsXHJcbiAgICAgICAgICAgICAgICBiaW5kaW5nczoge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2U6IFwiPFwiXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogJ2xnJ1xyXG4gICAgICAgICAgICB9KS5yZXN1bHQudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8oXCJJIHdhcyBjbG9zZWQsIHNvIGRvIHdoYXQgSSBuZWVkIHRvIGRvIG15Q29udGVudCdzIGNvbnRyb2xsZXIgbm93LiAgUmVzdWx0IHdhcy0+XCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5pbmZvKCdyZXR1cm5pbmcgcmVzdWx0JywgcmVzdWx0KTtcclxuICAgICAgICAgICAgICAgICRjdHJsLnB1Ymxpc2hlcnMudW5zaGlmdChyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuaWQgPSByZXN1bHQuaWQ7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhcIkkgd2FzIGRpbWlzc2VkLCBzbyBkbyB3aGF0IEkgbmVlZCB0byBkbyBteUNvbnRlbnQncyBjb250cm9sbGVyIG5vdy4gIFJlYXNvbiB3YXMtPlwiICsgcmVhc29uKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5lZGl0ID0gZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgJHVpYk1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiAncHVibGlzaGVyRWRpdCcsXHJcbiAgICAgICAgICAgICAgICBiaW5kaW5nczoge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2U6IFwiPFwiXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiAkY3RybC5pZFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNpemU6ICdsZydcclxuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKCRjdHJsLnB1Ymxpc2hlcnMsIGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uaWQgPT09ICRjdHJsLmlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKGl0ZW0sIHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRjdHJsLmlkID0gaXRlbS5pZDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhcIkkgd2FzIGRpbWlzc2VkLCBzbyBkbyB3aGF0IEkgbmVlZCB0byBkbyBteUNvbnRlbnQncyBjb250cm9sbGVyIG5vdy4gIFJlYXNvbiB3YXMtPlwiICsgcmVhc29uKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3B1Ymxpc2hlclNlbGVjdCcsXHJcbiAgICB7XHJcbiAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgaWQ6ICc9J1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvY29tbW9uL3B1Ymxpc2hlci1zZWxlY3QuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgICAgIGNvbnRyb2xsZXI6IFsnJGh0dHAnLCAnJHVpYk1vZGFsJywgY29udHJvbGxlcl1cclxuICAgIH0pO1xyXG5cclxuXHJcbn1cclxuKSgpOyIsIi8vZGlyZWN0aXZlcy5tb2R1bGVzLmpzXHJcbihmdW5jdGlvbigpIHtcclxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAuZGlyZWN0aXZlcycsIFtdKTsgXHJcbn0pKCk7IiwiLy9zdFRhYmxlLmRpcmVjdGl2ZS5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwLmRpcmVjdGl2ZXMnKTtcclxuXHJcbiAgICBtb2R1bGUuZGlyZWN0aXZlKCdzdFN1Ym1pdFNlYXJjaCcsIFsnc3RDb25maWcnLCAnJHRpbWVvdXQnLCAnJHBhcnNlJywgZnVuY3Rpb24gKHN0Q29uZmlnLCAkdGltZW91dCwgJHBhcnNlKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVxdWlyZTogJ15zdFRhYmxlJyxcclxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudC5iaW5kKCdjbGljaycsXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFibGVDdHJsID0gY3RybDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnBpcGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfV0pO1xyXG5cclxuICAgIG1vZHVsZS5kaXJlY3RpdmUoXCJjbGVhcktleVwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFQScsXHJcbiAgICAgICAgICAgIHJlcXVpcmU6ICduZ01vZGVsJyxcclxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbCwgYXR0cnMsIGN0cmwpIHtcclxuICAgICAgICAgICAgICAgIGVsLm9uKCdrZXlkb3duJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LndoaWNoICE9PSAyNykgeyByZXR1cm47IH0gLy8gY2hlY2sga2V5IGhvdyB5b3Ugd2FudFxyXG4gICAgICAgICAgICAgICAgICAgIGN0cmwuJHNldFZpZXdWYWx1ZShudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICBjdHJsLiRyZW5kZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICBtb2R1bGUuZGlyZWN0aXZlKFwic3RSZXNldFNlYXJjaFwiLFxyXG4gICAgICAgICAgICBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3RyaWN0OiAnRUEnLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmU6IFsnXnN0VGFibGUnLCAnXm5nTW9kZWwnXSxcclxuICAgICAgICAgICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBjdHJscykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudC5iaW5kKCdjbGljaycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vZGVsID0gY3RybHNbMV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN0cmwgPSBjdHJsc1swXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChtb2RlbC4kdmlld1ZhbHVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoa2V5LnRvTG93ZXJDYXNlKCkgPT09ICdwYWdlJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC4kdmlld1ZhbHVlW2tleV0gPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkgfHwgXy5pbmNsdWRlcyhrZXkudG9Mb3dlckNhc2UoKSwgJ3BhZ2UnKSkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLiR2aWV3VmFsdWVba2V5XSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlU3RhdGUgPSBjdHJsLnRhYmxlU3RhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVTdGF0ZS5zZWFyY2gucHJlZGljYXRlT2JqZWN0ID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlU3RhdGUucGFnaW5hdGlvbi5zdGFydCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjdHJsLnBpcGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgIG1vZHVsZS5kaXJlY3RpdmUoXCJzdENsZWFyS2V5XCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZXN0cmljdDogJ0VBJyxcclxuICAgICAgICAgICAgcmVxdWlyZTogWydec3RUYWJsZScsICdebmdNb2RlbCddLFxyXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBjdHJscykge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5vbigna2V5ZG93bicsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZ01vZGVsID0gY3RybHNbMV07XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN0cmwgPSBjdHJsc1swXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LndoaWNoID09PSAxMykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3RybC5waXBlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC53aGljaCA9PT0gMjcpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LmNvbnRleHQuYXR0cmlidXRlc1snc3Qtc2VhcmNoJ10gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpZWxkTmFtZSA9IGVsZW1lbnQuY29udGV4dC5hdHRyaWJ1dGVzWydzdC1zZWFyY2gnXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFibGVTdGF0ZSA9IGN0cmwudGFibGVTdGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlU3RhdGUuc2VhcmNoLnByZWRpY2F0ZU9iamVjdFtmaWVsZE5hbWVdID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGN0cmwucGlwZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmdNb2RlbC4kc2V0Vmlld1ZhbHVlKG51bGwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5nTW9kZWwuJHJlbmRlcigpOyAvLyB3aWxsIHVwZGF0ZSB0aGUgaW5wdXQgdmFsdWUgYXMgd2VsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcblxyXG59XHJcbikoKTsiLCIvL3Byb2R1Y3QtZWRpdC5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcihzZXJ2aWNlKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJGN0cmwudGl0bGUgPSAnTmV3IFByb2R1Y3QnOyBcclxuICAgICAgICAgICAgaWYgKCRjdHJsLnJlc29sdmUpIHtcclxuICAgICAgICAgICAgICAgICRjdHJsLmlkID0gJGN0cmwucmVzb2x2ZS5pZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoJGN0cmwuaWQpIHtcclxuICAgICAgICAgICAgICAgIHNlcnZpY2UuZ2V0UHJvZHVjdCgkY3RybC5pZCkudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgICRjdHJsLnByb2R1Y3QgPSByO1xyXG4gICAgICAgICAgICAgICAgICAgICRjdHJsLnRpdGxlID0gci50aXRsZTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkY3RybC5kaXNtaXNzKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5zYXZlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gc2VydmljZS5zYXZlKCRjdHJsLnByb2R1Y3QpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKCRjdHJsLnByb2R1Y3QsIHIpO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwubW9kYWxJbnN0YW5jZS5jbG9zZSgkY3RybC5wcm9kdWN0KTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yIHNhdmluZyBwcm9kdWN0JywgZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9KS5maW5hbGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuY29tcG9uZW50KCdwcm9kdWN0RWRpdCcsXHJcbiAgICB7XHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvcHJvZHVjdC9wcm9kdWN0LWVkaXQuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgIGlkOiAnPCcsXHJcbiAgICAgICAgICAgIHJlc29sdmU6ICc8JyxcclxuICAgICAgICAgICAgY2xvc2U6ICcmJyxcclxuICAgICAgICAgICAgZGlzbWlzczogJyYnLFxyXG4gICAgICAgICAgICBtb2RhbEluc3RhbmNlOiAnPCdcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNvbnRyb2xsZXI6IFsnUHJvZHVjdCcsIGNvbnRyb2xsZXJdXHJcbiAgICB9KTtcclxufSkoKTtcclxuICAgICIsIi8vcHJvZHVjdC1saXN0LmNvbXBvbmVudC5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcigkbW9kYWwsICRuZ0NvbmZpcm0sIHByb2R1Y3QsIHVzZXIsIGFkYWxTZXJ2aWNlKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuICAgICAgICB2YXIgcGFnZVNpemVEZWZhdWx0ID0gMTA7XHJcbiAgICAgICAgdmFyIHRhYmxlU3RhdGVSZWY7XHJcblxyXG4gICAgICAgICRjdHJsLnNlYXJjaE1vZGVsID0ge1xyXG4gICAgICAgICAgICBwYWdlOiAxLFxyXG4gICAgICAgICAgICBwYWdlU2l6ZTogcGFnZVNpemVEZWZhdWx0XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3Byb2R1Y3QgbGlzdCBpbml0Jyk7XHJcbiAgICAgICAgICAgICRjdHJsLnRpdGxlID0gJ1Byb2R1Y3QgTGlzdCc7XHJcbiAgICAgICAgICAgIC8vYWRhbFNlcnZpY2UubG9naW4oKTtcclxuICAgICAgICAgICAgdXNlci5nZXRUb2tlbigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuc2VhcmNoID0gZnVuY3Rpb24gKHRhYmxlU3RhdGUpIHtcclxuICAgICAgICAgICAgdGFibGVTdGF0ZVJlZiA9IHRhYmxlU3RhdGU7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzZWFyY2gnKTtcclxuICAgICAgICAgICAgcHJvZHVjdC5nZXRBbGxQcm9kdWN0cygkY3RybC5zZWFyY2hNb2RlbCkudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwucHJvZHVjdHMgPSByLnJlc3VsdHM7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5zZWFyY2hNb2RlbCA9IHI7XHJcbiAgICAgICAgICAgICAgICBkZWxldGUgJGN0cmwuc2VhcmNoTW9kZWwucmVzdWx0cztcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5wYWdlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJGN0cmwuc2VhcmNoKHRhYmxlU3RhdGVSZWYpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuY3JlYXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkbW9kYWwub3Blbih7XHJcbiAgICAgICAgICAgICAgICBjb21wb25lbnQ6ICdwcm9kdWN0RWRpdCcsXHJcbiAgICAgICAgICAgICAgICBiaW5kaW5nczoge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2U6IFwiPFwiXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogJ21kJ1xyXG4gICAgICAgICAgICB9KS5yZXN1bHQudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5wcm9kdWN0cy51bnNoaWZ0KHJlc3VsdCk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhcIkkgd2FzIGRpbWlzc2VkLCBzbyBkbyB3aGF0IEkgbmVlZCB0byBkbyBteUNvbnRlbnQncyBjb250cm9sbGVyIG5vdy4gIFJlYXNvbiB3YXMtPlwiICsgcmVhc29uKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5lZGl0ID0gZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgJG1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiAncHJvZHVjdEVkaXQnLFxyXG4gICAgICAgICAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlOiBcIjxcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBpZDogaXRlbS5pZFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNpemU6ICdtZCdcclxuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoaXRlbSwgcmVzdWx0KTtcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmRlbGV0ZSA9IGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICRuZ0NvbmZpcm0oe1xyXG4gICAgICAgICAgICAgICAgdGl0bGU6ICdEZWxldGUnLFxyXG4gICAgICAgICAgICAgICAgY29udGVudDogJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgPGJyIC8+PHN0cm9uZz4nICsgaXRlbS50aXRsZSArICc8L3N0cm9uZz4/JyxcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdyZWQnLFxyXG4gICAgICAgICAgICAgICAgYnV0dG9uczoge1xyXG4gICAgICAgICAgICAgICAgICAgIHllczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXlzOiBbJ3knXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBmdW5jdGlvbiAoc2NvcGUsIGJ1dHRvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdC5yZW1vdmUoaXRlbS5pZCkudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZHggPSAkY3RybC5wcm9kdWN0cy5pbmRleE9mKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjdHJsLnByb2R1Y3RzLnNwbGljZShpZHgsIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIG5vOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleXM6IFsnTiddLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb246IGZ1bmN0aW9uIChzY29wZSwgYnV0dG9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuc2hvd0RldGFpbHMgPSBmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICAkbW9kYWwub3Blbih7XHJcbiAgICAgICAgICAgICAgICBjb21wb25lbnQ6ICdwcm9kdWN0U3VtbWFyeScsXHJcbiAgICAgICAgICAgICAgICBiaW5kaW5nczoge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2U6IFwiPFwiXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBpdGVtLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFzTW9kYWw6IHRydWVcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzaXplOiAnbWQnXHJcbiAgICAgICAgICAgIH0pLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhcIkkgd2FzIGNsb3NlZCwgc28gZG8gd2hhdCBJIG5lZWQgdG8gZG8gbXlDb250ZW50J3MgY29udHJvbGxlciBub3cuICBSZXN1bHQgd2FzLT5cIik7XHJcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmV4dGVuZChpdGVtLCByZXN1bHQpO1xyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8oXCJJIHdhcyBkaW1pc3NlZCwgc28gZG8gd2hhdCBJIG5lZWQgdG8gZG8gbXlDb250ZW50J3MgY29udHJvbGxlciBub3cuICBSZWFzb24gd2FzLT5cIiArIHJlYXNvbik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuY29tcG9uZW50KCdwcm9kdWN0TGlzdCcsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9wcm9kdWN0L3Byb2R1Y3QtbGlzdC5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJHVpYk1vZGFsJywgJyRuZ0NvbmZpcm0nLCAnUHJvZHVjdCcsICdVc2VyJywgJ2FkYWxBdXRoZW50aWNhdGlvblNlcnZpY2UnLCBjb250cm9sbGVyXVxyXG4gICAgICAgIH0pO1xyXG5cclxufVxyXG4pKCk7IiwiLy9wcm9kdWN0LXN1bW1hcnkuY29tcG9uZW50LmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoJG1vZGFsLCBzZXJ2aWNlKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCRjdHJsLnJlc29sdmUpIHtcclxuICAgICAgICAgICAgICAgICRjdHJsLmlkID0gJGN0cmwucmVzb2x2ZS5pZDtcclxuICAgICAgICAgICAgICAgICRjdHJsLmFzTW9kYWwgPSAkY3RybC5yZXNvbHZlLmFzTW9kYWw7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5hZGRTdGFmZlZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2VydmljZS5nZXRQcm9kdWN0KCRjdHJsLmlkKS50aGVuKGZ1bmN0aW9uIChyKSB7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5wcm9kdWN0ID0gcjtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5lZGl0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRtb2RhbC5vcGVuKHtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudDogJ3Byb2R1Y3RFZGl0JyxcclxuICAgICAgICAgICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kYWxJbnN0YW5jZTogXCI8XCJcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWQ6ICRjdHJsLnByb2R1Y3QuaWRcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzaXplOiAnbWQnXHJcbiAgICAgICAgICAgIH0pLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKCRjdHJsLnByb2R1Y3QsIHJlc3VsdCk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5zaG93TmV3U3RhZmYgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJG1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiAnc3RhZmZFZGl0JyxcclxuICAgICAgICAgICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kYWxJbnN0YW5jZTogXCI8XCJcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdElkOiAkY3RybC5pZFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNpemU6ICdtZCdcclxuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5pbmZvKFwiSSB3YXMgY2xvc2VkLCBzbyBkbyB3aGF0IEkgbmVlZCB0byBkbyBteUNvbnRlbnQncyBjb250cm9sbGVyIG5vdy4gIFJlc3VsdCB3YXMtPlwiKTtcclxuICAgICAgICAgICAgICAgICRjdHJsLnByb2R1Y3Quc3RhZmYudW5zaGlmdChyZXN1bHQpO1xyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8oXCJJIHdhcyBkaW1pc3NlZCwgc28gZG8gd2hhdCBJIG5lZWQgdG8gZG8gbXlDb250ZW50J3MgY29udHJvbGxlciBub3cuICBSZWFzb24gd2FzLT5cIiArIHJlYXNvbik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkY3RybC5tb2RhbEluc3RhbmNlLmNsb3NlKCRjdHJsLnByb2R1Y3QpO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgbW9kdWxlLmNvbXBvbmVudCgncHJvZHVjdFN1bW1hcnknLFxyXG4gICAge1xyXG4gICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgIGlkOiAnPCcsXHJcbiAgICAgICAgICAgIGFzTW9kYWw6ICc8JyxcclxuICAgICAgICAgICAgcmVzb2x2ZTogJzwnLFxyXG4gICAgICAgICAgICBjbG9zZTogJyYnLFxyXG4gICAgICAgICAgICBkaXNtaXNzOiAnJicsIFxyXG4gICAgICAgICAgICBtb2RhbEluc3RhbmNlOiAnPCdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3Byb2R1Y3QvcHJvZHVjdC1zdW1tYXJ5LmNvbXBvbmVudC5odG1sJyxcclxuICAgICAgICBjb250cm9sbGVyOiBbJyR1aWJNb2RhbCcsICdQcm9kdWN0JywgY29udHJvbGxlcl1cclxuICAgIH0pO1xyXG5cclxufVxyXG4pKCk7IiwiLy9hdXRoLnNlcnZpY2UuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gc2VydmljZSgkaHR0cCwgJGxvY2FsU3RvcmFnZSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGdldFRva2VuOiBnZXRUb2tlblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0VG9rZW4oKSB7XHJcbiAgICAgICAgICAgIGlmICgkbG9jYWxTdG9yYWdlLmN1cnJlbnRVc2VyKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFVzZXIgPSAkbG9jYWxTdG9yYWdlLmN1cnJlbnRVc2VyO1xyXG4gICAgICAgICAgICAgICAgJGh0dHAucG9zdCgnYXBpL2F1dGgvYXV0aGVudGljYXRlP3VzZXI9JyArXHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFVzZXIudXNlciArXHJcbiAgICAgICAgICAgICAgICAgICAgJyZwYXNzd29yZD0nICtcclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50VXNlci5wYXNzd29yZCkudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VXNlci50b2tlbiA9IHIuZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2FsU3RvcmFnZS5jdXJyZW50VXNlciA9IGN1cnJlbnRVc2VyO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuc2VydmljZSgnVXNlcicsIFsnJGh0dHAnLCAnJGxvY2FsU3RvcmFnZScsIHNlcnZpY2VdKTtcclxufVxyXG4pKCk7IiwiLy9wcm9kdWN0LnNlcnZpY2UuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7IFxyXG4gICAgXHJcbiAgICBtb2R1bGUuZmFjdG9yeSgnUHJvZHVjdCcsIFsnJGh0dHAnLCBzZXJ2aWNlQ29udHJvbGxlcl0pO1xyXG5cclxuICAgIGZ1bmN0aW9uIHNlcnZpY2VDb250cm9sbGVyKCRodHRwKSB7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGdldFByb2R1Y3Q6IGdldFByb2R1Y3QsXHJcbiAgICAgICAgICAgIGdldEFsbFByb2R1Y3RzOiBnZXRBbGxQcm9kdWN0cyxcclxuICAgICAgICAgICAgcmVtb3ZlOiByZW1vdmUsIFxyXG4gICAgICAgICAgICBzYXZlOiBzYXZlXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0UHJvZHVjdChpZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCdhcGkvcHJvZHVjdC8nICsgaWQpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByLmRhdGE7XHJcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVyci5tZXNzYWdlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZXRBbGxQcm9kdWN0cyhzZWFyY2hNb2RlbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCdhcGkvcHJvZHVjdCcsIHsgcGFyYW1zOiBzZWFyY2hNb2RlbCB9KS50aGVuKGZ1bmN0aW9uIChyKSB7XHJcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdwcm9kdWN0cycsIHIuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gci5kYXRhO1xyXG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIubWVzc2FnZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlKGlkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5kZWxldGUoJ2FwaS9wcm9kdWN0LycgKyBpZCkudGhlbihmdW5jdGlvbihyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gci5kYXRhO1xyXG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVyci5tZXNzYWdlKTtcclxuICAgICAgICAgICAgfSk7IFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2F2ZShwcm9kdWN0KSB7XHJcbiAgICAgICAgICAgIGlmIChwcm9kdWN0LmlkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJGh0dHAucHV0KCdhcGkvcHJvZHVjdCcsIHByb2R1Y3QpLnRoZW4oZnVuY3Rpb24ocikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByLmRhdGE7XHJcbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXJyLm1lc3NhZ2U7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCdhcGkvcHJvZHVjdCcsIHByb2R1Y3QpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gci5kYXRhO1xyXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlcnIubWVzc2FnZTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbn1cclxuKSgpOyIsIi8vc3RhZmYtZWRpdC5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcigkaHR0cCkge1xyXG4gICAgICAgIHZhciAkY3RybCA9IHRoaXM7XHJcblxyXG4gICAgICAgICRjdHJsLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzdGFmZiBlZGl0IGluaXQnKTtcclxuICAgICAgICAgICAgJGN0cmwudGl0bGUgPSAnTmV3IFN0YWZmJztcclxuXHJcbiAgICAgICAgICAgIGlmICgkY3RybC5yZXNvbHZlKSAkY3RybC5wcm9kdWN0SWQgPSAkY3RybC5yZXNvbHZlLnByb2R1Y3RJZDtcclxuXHJcbiAgICAgICAgICAgIGlmICgkY3RybC5yZXNvbHZlLnN0YWZmKSB7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5zdGFmZiA9ICRjdHJsLnJlc29sdmUuc3RhZmY7XHJcbiAgICAgICAgICAgICAgICAkY3RybC50aXRsZSA9ICRjdHJsLnN0YWZmLmZpcnN0bmFtZSArICcgJyArICRjdHJsLnN0YWZmLmxhc3RuYW1lO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRjdHJsLmRpc21pc3MoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkY3RybC5zYXZlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoJGN0cmwucHJvZHVjdElkKSB7XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5wb3N0KCdhcGkvc3RhZmYvJyArICRjdHJsLnByb2R1Y3RJZCwgJGN0cmwuc3RhZmYpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmV4dGVuZCgkY3RybC5zdGFmZiwgci5kYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAkY3RybC5tb2RhbEluc3RhbmNlLmNsb3NlKHIuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3NvbWV0aGluZyB3ZW50IHdyb25nJywgZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5wb3N0KCdhcGkvc3RhZmYnLCAkY3RybC5zdGFmZikudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKCRjdHJsLnN0YWZmLCByLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICRjdHJsLm1vZGFsSW5zdGFuY2UuY2xvc2Uoci5kYXRhKTtcclxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc29tZXRoaW5nIHdlbnQgd3JvbmcnLCBlcnIubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgbW9kdWxlLmNvbXBvbmVudCgnc3RhZmZFZGl0JyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiAnPCcsXHJcbiAgICAgICAgICAgICAgICBjbG9zZTogJyYnLFxyXG4gICAgICAgICAgICAgICAgZGlzbWlzczogJyYnLFxyXG4gICAgICAgICAgICAgICAgc3RhZmY6ICc8JyxcclxuICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogJzwnLFxyXG4gICAgICAgICAgICAgICAgbW9kYWxJbnN0YW5jZTogJzwnXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3N0YWZmL3N0YWZmLWVkaXQuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiBbJyRodHRwJywgY29udHJvbGxlcl1cclxuICAgICAgICB9KTtcclxufVxyXG4pKCk7IiwiLy9zdGFmZi1saXN0LmNvbXBvbmVudC5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnKTtcclxuXHJcbiAgICBmdW5jdGlvbiBjb250cm9sbGVyKCRodHRwLCAkbW9kYWwsICRuZ0NvbmZpcm0pIHtcclxuICAgICAgICB2YXIgJGN0cmwgPSB0aGlzO1xyXG5cclxuICAgICAgICAkY3RybC4kb25Jbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnc3RhZmYgbGlzdCBpbml0Jyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5lZGl0ID0gZnVuY3Rpb24gKG1lbWJlcikge1xyXG4gICAgICAgICAgICAkbW9kYWwub3Blbih7XHJcbiAgICAgICAgICAgICAgICBjb21wb25lbnQ6ICdzdGFmZkVkaXQnLFxyXG4gICAgICAgICAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlOiBcIjxcIixcclxuICAgICAgICAgICAgICAgICAgICBzdGFmZjogbWVtYmVyXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YWZmOiBtZW1iZXJcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzaXplOiAnbWQnXHJcbiAgICAgICAgICAgIH0pLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhcIkkgd2FzIGNsb3NlZCwgc28gZG8gd2hhdCBJIG5lZWQgdG8gZG8gbXlDb250ZW50J3MgY29udHJvbGxlciBub3cuICBSZXN1bHQgd2FzLT5cIik7XHJcblxyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8oXCJJIHdhcyBkaW1pc3NlZCwgc28gZG8gd2hhdCBJIG5lZWQgdG8gZG8gbXlDb250ZW50J3MgY29udHJvbGxlciBub3cuICBSZWFzb24gd2FzLT5cIiArIHJlYXNvbik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuZGVsZXRlID0gZnVuY3Rpb24gKG1lbWJlcikge1xyXG4gICAgICAgICAgICAkbmdDb25maXJtKHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiAnRGVsZXRlJyxcclxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIDxiciAvPjxzdHJvbmc+JyArIG1lbWJlci5maXJzdG5hbWUgKyBtZW1iZXIubGFzdG5hbWUgKyAnPC9zdHJvbmc+PycsXHJcbiAgICAgICAgICAgICAgICB0eXBlOiAncmVkJyxcclxuICAgICAgICAgICAgICAgIGJ1dHRvbnM6IHtcclxuICAgICAgICAgICAgICAgICAgICB5ZXM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAga2V5czogWyd5J10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbjogZnVuY3Rpb24gKHNjb3BlLCBidXR0b24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRodHRwLmRlbGV0ZSgnYXBpL3N0YWZmLycgKyBtZW1iZXIuaWQpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWR4ID0gJGN0cmwuc3RhZmYuaW5kZXhPZihtZW1iZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjdHJsLnN0YWZmLnNwbGljZShpZHgsIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnJvcicsIGVyci5tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBubzoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXlzOiBbJ04nXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBmdW5jdGlvbiAoc2NvcGUsIGJ1dHRvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuY29tcG9uZW50KCdzdGFmZkxpc3QnLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgICAgIHN0YWZmOiAnPCdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvc3RhZmYvc3RhZmYtbGlzdC5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJGh0dHAnLCAnJHVpYk1vZGFsJywgJyRuZ0NvbmZpcm0nLCBjb250cm9sbGVyXVxyXG4gICAgICAgIH0pO1xyXG59XHJcbikoKTsiXX0=
