!function(){"use strict";var t=angular.module("app",["ngStorage","app.directives","shared.components","ui.bootstrap","smart-table","cp.ngConfirm","treasure-overlay-spinner","toastr"]);t.config(["toastrConfig",function(t){angular.extend(t,{positionClass:"toast-bottom-right",newestOnTop:!0,allowHtml:!1,closeButton:!1,closeHtml:"<button>&times;</button>",extendedTimeOut:1e3,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},messageClass:"toast-message",onHidden:null,onShown:null,onTap:null,progressBar:!1,tapToDismiss:!0,templates:{toast:"directives/toast/toast.html",progressbar:"directives/progressbar/progressbar.html"},timeOut:5e3,titleClass:"toast-title",toastClass:"toast"})}])}();
!function(){angular.module("shared.components",[])}();
!function(){function n(){var n=this;n.$onInit=function(){console.log("modal",n)}}var o=angular.module("app");o.component("confirmationModal",{bindings:{},template:"yes or no",controller:[n]})}();
!function(){function n(n,o){var e=this;e.$onInit=function(){n.get("api/publisher").then(function(n){e.publishers=n.data}).catch(function(n){console.log(n.message)})},e.create=function(){o.open({component:"publisherEdit",bindings:{modalInstance:"<"},size:"lg"}).result.then(function(n){console.info("I was closed, so do what I need to do myContent's controller now.  Result was->"),console.info("returning result",n),e.publishers.unshift(n),e.id=n.id},function(n){console.info("I was dimissed, so do what I need to do myContent's controller now.  Reason was->"+n)})},e.edit=function(){o.open({component:"publisherEdit",bindings:{modalInstance:"<"},resolve:{id:e.id},size:"lg"}).result.then(function(n){angular.forEach(e.publishers,function(o){o.id===e.id&&(angular.extend(o,n),e.id=o.id)})},function(n){console.info("I was dimissed, so do what I need to do myContent's controller now.  Reason was->"+n)})}}var o=angular.module("shared.components");o.component("publisherSelect",{bindings:{id:"="},templateUrl:"app/common/publisher-select.component.html",controller:["$http","$uibModal",n]})}();
!function(){angular.module("app.directives",[])}();
!function(){var e=angular.module("app.directives");e.directive("stSubmitSearch",["stConfig","$timeout","$parse",function(e,t,r){return{require:"^stTable",link:function(e,t,r,n){return t.bind("click",function(){var e=n;e.pipe()})}}}]),e.directive("clearKey",function(){return{restrict:"EA",require:"ngModel",link:function(e,t,r,n){t.on("keydown",function(t){27===t.which&&(n.$setViewValue(null),n.$render(),e.$apply())})}}}),e.directive("stResetSearch",function(){return{restrict:"EA",require:["^stTable","^ngModel"],link:function(e,t,r,n){return t.bind("click",function(){var t=n[1],r=n[0];return e.$apply(function(){angular.forEach(t.$viewValue,function(e,r){"page"===r.toLowerCase()&&(t.$viewValue[r]=1),Array.isArray(e)||_.includes(r.toLowerCase(),"page")||(t.$viewValue[r]=null)});var e=r.tableState();return e.search.predicateObject={},e.pagination.start=0,r.pipe()})})}}}),e.directive("stClearKey",function(){return{restrict:"EA",require:["^stTable","^ngModel"],link:function(e,t,r,n){t.on("keydown",function(r){var i=n[1],a=n[0];return 13===r.which?a.pipe():27===r.which?void 0!==t.context.attributes["st-search"]?e.$apply(function(){var e=t.context.attributes["st-search"].value,r=a.tableState();return r.search.predicateObject[e]="",a.pipe()}):e.$apply(function(){i.$setViewValue(null),i.$render()}):void 0})}}})}();
!function(){function t(t){var e=this;e.dateOptions={dateDisabled:!1,formatYear:"yy"},e.dateFormat="MM/DD/YYYY",e.$onInit=function(){e.title="New Product",e.resolve&&(e.id=e.resolve.id),e.id&&t.getProduct(e.id).then(function(t){e.product=t,e.title=t.title,e.product.receiptDate=new Date(t.receiptDate)})},e.cancel=function(){e.dismiss()},e.save=function(){return t.save(e.product).then(function(t){angular.extend(e.product,t),e.modalInstance.close(e.product)}).catch(function(t){console.log("Error saving product",t.message)}).finally(function(){})}}var e=angular.module("app");e.component("productEdit",{templateUrl:"app/product/product-edit.component.html",bindings:{id:"<",resolve:"<",close:"&",dismiss:"&",modalInstance:"<"},controller:["Product",t]})}();
!function(){"use strict";function n(n,t,o,e){var i,s=this,d=10;s.searchModel={page:1,pageSize:d,filteredCount:0,totalCount:0,totalPages:0},s.$onInit=function(){console.log("product list init"),s.title="Media Library",s.loading=!0},s.search=function(n){s.loading=!0,i=n,e.getAllProducts(s.searchModel).then(function(n){s.products=n.results,s.searchModel=n,delete s.searchModel.results,s.loading=!1}).catch(function(n){s.loading=!1}).finally(function(){})},s.paged=function(){s.search(i)},s.create=function(){n.open({component:"productEdit",bindings:{modalInstance:"<"},size:"md"}).result.then(function(n){s.products.unshift(n),o.info("Created "+n.title)},function(n){console.info("I was dimissed, so do what I need to do myContent's controller now.  Reason was->"+n)})},s.edit=function(t){n.open({component:"productEdit",bindings:{modalInstance:"<"},resolve:{id:t.id},size:"md"}).result.then(function(n){angular.extend(t,n),o.info("Saved "+n.title)},function(n){})},s.delete=function(n){t({title:"Delete",content:"Are you sure you want to delete <br /><strong>"+n.title+"</strong>?",type:"red",buttons:{yes:{keys:["y"],action:function(t,i){e.remove(n.id).then(function(t){var e=s.products.indexOf(n);s.products.splice(e,1),o.warning("Deleted "+n.title)})}},no:{keys:["N"],action:function(n,t){}}}})},s.showDetails=function(t){n.open({component:"productSummary",bindings:{modalInstance:"<"},resolve:{id:t.id,asModal:!0},size:"md"}).result.then(function(n){console.info("I was closed, so do what I need to do myContent's controller now.  Result was->"),angular.extend(t,n)},function(n){console.info("I was dimissed, so do what I need to do myContent's controller now.  Reason was->"+n)})}}var t=angular.module("app");t.component("productList",{templateUrl:"app/product/product-list.component.html",controller:["$uibModal","$ngConfirm","toastr","Product",n]})}();
!function(){function o(o,n){var t=this;t.$onInit=function(){t.loading=!0,t.resolve&&(t.id=t.resolve.id,t.asModal=t.resolve.asModal,t.addStaffVisible=!1),n.getProduct(t.id).then(function(o){t.product=o,t.loading=!1})},t.edit=function(){o.open({component:"productEdit",bindings:{modalInstance:"<"},resolve:{id:t.product.id},size:"md"}).result.then(function(o){angular.extend(t.product,o)},function(o){})},t.showNewStaff=function(){o.open({component:"staffEdit",bindings:{modalInstance:"<"},resolve:{productId:t.id},size:"md"}).result.then(function(o){console.info("I was closed, so do what I need to do myContent's controller now.  Result was->"),t.product.staff.unshift(o)},function(o){console.info("I was dimissed, so do what I need to do myContent's controller now.  Reason was->"+o)})},t.cancel=function(){t.modalInstance.close(t.product)}}var n=angular.module("app");n.component("productSummary",{bindings:{id:"<",asModal:"<",resolve:"<",close:"&",dismiss:"&",modalInstance:"<"},templateUrl:"app/product/product-summary.component.html",controller:["$uibModal","Product",o]})}();
!function(){"use strict";function t(t){function n(n){return t.get("api/product/"+n).then(function(t){return t.data}).catch(function(t){console.log(t.message)})}function e(n){return t.get("api/product",{params:n}).then(function(t){return t.data}).catch(function(t){console.log(t.message)})}function u(n){return t.delete("api/product/"+n).then(function(t){return t.data}).catch(function(t){console.log(t.message)})}function c(n){return n.id?t.put("api/product",n).then(function(t){return t.data}).catch(function(t){return t.message}):t.post("api/product",n).then(function(t){return t.data}).catch(function(t){return t.message})}return{getProduct:n,getAllProducts:e,remove:u,save:c}}var n=angular.module("app");n.factory("Product",["$http",t])}();
!function(){function t(t){var a=this;a.$onInit=function(){console.log("staff edit init"),a.title="New Staff",a.resolve&&(a.productId=a.resolve.productId),a.resolve.staff&&(a.staff=a.resolve.staff,a.title=a.staff.firstname+" "+a.staff.lastname)},a.cancel=function(){a.dismiss()},a.save=function(){a.productId?t.post("api/staff/"+a.productId,a.staff).then(function(t){angular.extend(a.staff,t.data),a.modalInstance.close(t.data)}).catch(function(t){console.log("something went wrong",t.message)}):t.post("api/staff",a.staff).then(function(t){angular.extend(a.staff,t.data),a.modalInstance.close(t.data)}).catch(function(t){console.log("something went wrong",t.message)})}}var a=angular.module("app");a.component("staffEdit",{bindings:{resolve:"<",close:"&",dismiss:"&",staff:"<",productId:"<",modalInstance:"<"},templateUrl:"app/staff/staff-edit.component.html",controller:["$http",t]})}();
!function(){function t(t,n,o){var e=this;e.$onInit=function(){console.log("staff list init")},e.edit=function(t){n.open({component:"staffEdit",bindings:{modalInstance:"<",staff:t},resolve:{staff:t},size:"md"}).result.then(function(t){console.info("I was closed, so do what I need to do myContent's controller now.  Result was->")},function(t){console.info("I was dimissed, so do what I need to do myContent's controller now.  Reason was->"+t)})},e.delete=function(n){o({title:"Delete",content:"Are you sure you want to delete <br /><strong>"+n.firstname+n.lastname+"</strong>?",type:"red",buttons:{yes:{keys:["y"],action:function(o,s){t.delete("api/staff/"+n.id).then(function(t){var o=e.staff.indexOf(n);e.staff.splice(o,1)}).catch(function(t){console.log("error",t.message)})}},no:{keys:["N"],action:function(t,n){}}}})}}var n=angular.module("app");n.component("staffList",{bindings:{staff:"<"},templateUrl:"app/staff/staff-list.component.html",controller:["$http","$uibModal","$ngConfirm",t]})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJjb21tb24vY29tcG9uZW50cy5tb2R1bGUuanMiLCJjb21tb24vY29uZnJtYXRpb24tbW9kYWwuY29tcG9uZW50LmpzIiwiY29tbW9uL3B1Ymxpc2hlci1zZWxlY3QuY29tcG9uZW50LmpzIiwiZGlyZWN0aXZlcy9kaXJlY3RpdmVzLm1vZHVsZXMuanMiLCJkaXJlY3RpdmVzL3N0VGFibGUuZGlyZWN0aXZlLmpzIiwicHJvZHVjdC9wcm9kdWN0LWVkaXQuY29tcG9uZW50LmpzIiwicHJvZHVjdC9wcm9kdWN0LWxpc3QuY29tcG9uZW50LmpzIiwicHJvZHVjdC9wcm9kdWN0LXN1bW1hcnkuY29tcG9uZW50LmpzIiwic2VydmljZXMvcHJvZHVjdC5zZXJ2aWNlLmpzIiwic3RhZmYvc3RhZmYtZWRpdC5jb21wb25lbnQuanMiLCJzdGFmZi9zdGFmZi1saXN0LmNvbXBvbmVudC5qcyJdLCJuYW1lcyI6WyJtb2R1bGUiLCJhbmd1bGFyIiwiY29uZmlnIiwidG9hc3RyQ29uZmlnIiwiZXh0ZW5kIiwicG9zaXRpb25DbGFzcyIsIm5ld2VzdE9uVG9wIiwiYWxsb3dIdG1sIiwiY2xvc2VCdXR0b24iLCJjbG9zZUh0bWwiLCJleHRlbmRlZFRpbWVPdXQiLCJpY29uQ2xhc3NlcyIsImVycm9yIiwiaW5mbyIsInN1Y2Nlc3MiLCJ3YXJuaW5nIiwibWVzc2FnZUNsYXNzIiwib25IaWRkZW4iLCJvblNob3duIiwib25UYXAiLCJwcm9ncmVzc0JhciIsInRhcFRvRGlzbWlzcyIsInRlbXBsYXRlcyIsInRvYXN0IiwicHJvZ3Jlc3NiYXIiLCJ0aW1lT3V0IiwidGl0bGVDbGFzcyIsInRvYXN0Q2xhc3MiLCJjb250cm9sbGVyIiwiJGN0cmwiLCJ0aGlzIiwiJG9uSW5pdCIsImNvbnNvbGUiLCJsb2ciLCJjb21wb25lbnQiLCJiaW5kaW5ncyIsInRlbXBsYXRlIiwiJGh0dHAiLCIkdWliTW9kYWwiLCJnZXQiLCJ0aGVuIiwiciIsInB1Ymxpc2hlcnMiLCJkYXRhIiwiY2F0Y2giLCJlcnIiLCJtZXNzYWdlIiwiY3JlYXRlIiwib3BlbiIsIm1vZGFsSW5zdGFuY2UiLCJzaXplIiwicmVzdWx0IiwidW5zaGlmdCIsImlkIiwicmVhc29uIiwiZWRpdCIsInJlc29sdmUiLCJmb3JFYWNoIiwiaXRlbSIsInRlbXBsYXRlVXJsIiwiZGlyZWN0aXZlIiwic3RDb25maWciLCIkdGltZW91dCIsIiRwYXJzZSIsInJlcXVpcmUiLCJsaW5rIiwic2NvcGUiLCJlbGVtZW50IiwiYXR0ciIsImN0cmwiLCJiaW5kIiwidGFibGVDdHJsIiwicGlwZSIsInJlc3RyaWN0IiwiZWwiLCJhdHRycyIsIm9uIiwiZXZlbnQiLCJ3aGljaCIsIiRzZXRWaWV3VmFsdWUiLCIkcmVuZGVyIiwiJGFwcGx5IiwiY3RybHMiLCJtb2RlbCIsIiR2aWV3VmFsdWUiLCJ2YWx1ZSIsImtleSIsInRvTG93ZXJDYXNlIiwiQXJyYXkiLCJpc0FycmF5IiwiXyIsImluY2x1ZGVzIiwidGFibGVTdGF0ZSIsInNlYXJjaCIsInByZWRpY2F0ZU9iamVjdCIsInBhZ2luYXRpb24iLCJzdGFydCIsIm5nTW9kZWwiLCJ1bmRlZmluZWQiLCJjb250ZXh0IiwiYXR0cmlidXRlcyIsImZpZWxkTmFtZSIsInNlcnZpY2UiLCJkYXRlT3B0aW9ucyIsImRhdGVEaXNhYmxlZCIsImZvcm1hdFllYXIiLCJkYXRlRm9ybWF0IiwidGl0bGUiLCJnZXRQcm9kdWN0IiwicHJvZHVjdCIsInJlY2VpcHREYXRlIiwiRGF0ZSIsImNhbmNlbCIsImRpc21pc3MiLCJzYXZlIiwiY2xvc2UiLCJmaW5hbGx5IiwiJG1vZGFsIiwiJG5nQ29uZmlybSIsInRvYXN0ciIsInRhYmxlU3RhdGVSZWYiLCJwYWdlU2l6ZURlZmF1bHQiLCJzZWFyY2hNb2RlbCIsInBhZ2UiLCJwYWdlU2l6ZSIsImZpbHRlcmVkQ291bnQiLCJ0b3RhbENvdW50IiwidG90YWxQYWdlcyIsImxvYWRpbmciLCJnZXRBbGxQcm9kdWN0cyIsInByb2R1Y3RzIiwicmVzdWx0cyIsInBhZ2VkIiwiZGVsZXRlIiwiY29udGVudCIsInR5cGUiLCJidXR0b25zIiwieWVzIiwia2V5cyIsImFjdGlvbiIsImJ1dHRvbiIsInJlbW92ZSIsImlkeCIsImluZGV4T2YiLCJzcGxpY2UiLCJubyIsInNob3dEZXRhaWxzIiwiYXNNb2RhbCIsImFkZFN0YWZmVmlzaWJsZSIsInNob3dOZXdTdGFmZiIsInByb2R1Y3RJZCIsInN0YWZmIiwic2VydmljZUNvbnRyb2xsZXIiLCJwYXJhbXMiLCJwdXQiLCJwb3N0IiwiZmFjdG9yeSIsImZpcnN0bmFtZSIsImxhc3RuYW1lIiwibWVtYmVyIl0sIm1hcHBpbmdzIjoiQ0FDQSxXQUNJLFlBRUEsSUFBSUEsR0FBU0MsUUFBUUQsT0FBTyxPQUV4QixZQUNBLGlCQUNBLG9CQUNBLGVBQ0EsY0FDQSxlQUNBLDJCQUNBLFVBR0pBLEdBQU9FLFFBQVEsZUFBZ0IsU0FBVUMsR0FDckNGLFFBQVFHLE9BQU9ELEdBQ1hFLGNBQWUscUJBQ2ZDLGFBQWEsRUFDYkMsV0FBVyxFQUNYQyxhQUFhLEVBQ2JDLFVBQVcsMkJBQ1hDLGdCQUFpQixJQUNqQkMsYUFDSUMsTUFBTyxjQUNQQyxLQUFNLGFBQ05DLFFBQVMsZ0JBQ1RDLFFBQVMsaUJBRWJDLGFBQWMsZ0JBQ2RDLFNBQVUsS0FDVkMsUUFBUyxLQUNUQyxNQUFPLEtBQ1BDLGFBQWEsRUFDYkMsY0FBYyxFQUNkQyxXQUNJQyxNQUFPLDhCQUNQQyxZQUFhLDJDQUVqQkMsUUFBUyxJQUNUQyxXQUFZLGNBQ1pDLFdBQVk7Q0N6Q3hCLFdBQ3FCMUIsUUFBUUQsT0FBTztDQ0RwQyxXQUdJLFFBQVM0QixLQUNMLEdBQUlDLEdBQVFDLElBRVpELEdBQU1FLFFBQVUsV0FDWkMsUUFBUUMsSUFBSSxRQUFTSixJQU43QixHQUFJN0IsR0FBU0MsUUFBUUQsT0FBTyxNQVc1QkEsR0FBT2tDLFVBQVUscUJBRVRDLFlBRUFDLFNBQVUsWUFDVlIsWUFBYUE7Q0NqQnpCLFdBSUksUUFBU0EsR0FBV1MsRUFBT0MsR0FDdkIsR0FBSVQs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Q1AyQixRQUFTLGlEQUFtRHlCLEVBQU9GLFVBQVlFLEVBQU9ELFNBQVcsYUFDakd2QixLQUFNLE1BQ05DLFNBQ0lDLEtBQ0lDLE1BQU8sS0FDUEMsT0FBUSxTQUFVekUsRUFBTzBFLEdBQ3JCdkcsRUFBTWdHLE9BQU8sYUFBZTBCLEVBQU8xRyxJQUFJYixLQUFLLFNBQVVDLEdBQ2xELEdBQUlxRyxHQUFNakgsRUFBTTBILE1BQU1SLFFBQVFnQixFQUM5QmxJLEdBQU0wSCxNQUFNUCxPQUFPRixFQUFLLEtBQ3pCbEcsTUFBTSxTQUFVQyxHQUNmYixRQUFRQyxJQUFJLFFBQVNZLEVBQUlDLGFBSXJDbUcsSUFDSVAsTUFBTyxLQUNQQyxPQUFRLFNBQVV6RSxFQUFPMEUsVUEvQzdDLEdBQUk1SSxHQUFTQyxRQUFRRCxPQUFPLE1BeUQ1QkEsR0FBT2tDLFVBQVUsYUFFVEMsVUFDSW9ILE1BQU8sS0FFWDVGLFlBQWEsc0NBQ2IvQixZQUFhLFFBQVMsWUFBYSxhQUFjQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy9hcHAubW9kdWxlLmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnLFxyXG4gICAgW1xyXG4gICAgICAgICduZ1N0b3JhZ2UnLFxyXG4gICAgICAgICdhcHAuZGlyZWN0aXZlcycsXHJcbiAgICAgICAgJ3NoYXJlZC5jb21wb25lbnRzJyxcclxuICAgICAgICAndWkuYm9vdHN0cmFwJyxcclxuICAgICAgICAnc21hcnQtdGFibGUnLFxyXG4gICAgICAgICdjcC5uZ0NvbmZpcm0nLCBcclxuICAgICAgICAndHJlYXN1cmUtb3ZlcmxheS1zcGlubmVyJywgXHJcbiAgICAgICAgJ3RvYXN0cidcclxuICAgICAgICBdKTtcclxuXHJcbiAgICBtb2R1bGUuY29uZmlnKFsndG9hc3RyQ29uZmlnJywgZnVuY3Rpb24gKHRvYXN0ckNvbmZpZykge1xyXG4gICAgICAgIGFuZ3VsYXIuZXh0ZW5kKHRvYXN0ckNvbmZpZywge1xyXG4gICAgICAgICAgICBwb3NpdGlvbkNsYXNzOiAndG9hc3QtYm90dG9tLXJpZ2h0JyxcclxuICAgICAgICAgICAgbmV3ZXN0T25Ub3A6IHRydWUsXHJcbiAgICAgICAgICAgIGFsbG93SHRtbDogZmFsc2UsXHJcbiAgICAgICAgICAgIGNsb3NlQnV0dG9uOiBmYWxzZSxcclxuICAgICAgICAgICAgY2xvc2VIdG1sOiAnPGJ1dHRvbj4mdGltZXM7PC9idXR0b24+JyxcclxuICAgICAgICAgICAgZXh0ZW5kZWRUaW1lT3V0OiAxMDAwLFxyXG4gICAgICAgICAgICBpY29uQ2xhc3Nlczoge1xyXG4gICAgICAgICAgICAgICAgZXJyb3I6ICd0b2FzdC1lcnJvcicsXHJcbiAgICAgICAgICAgICAgICBpbmZvOiAndG9hc3QtaW5mbycsXHJcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiAndG9hc3Qtc3VjY2VzcycsXHJcbiAgICAgICAgICAgICAgICB3YXJuaW5nOiAndG9hc3Qtd2FybmluZydcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbWVzc2FnZUNsYXNzOiAndG9hc3QtbWVzc2FnZScsXHJcbiAgICAgICAgICAgIG9uSGlkZGVuOiBudWxsLFxyXG4gICAgICAgICAgICBvblNob3duOiBudWxsLFxyXG4gICAgICAgICAgICBvblRhcDogbnVsbCxcclxuICAgICAgICAgICAgcHJvZ3Jlc3NCYXI6IGZhbHNlLFxyXG4gICAgICAgICAgICB0YXBUb0Rpc21pc3M6IHRydWUsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlczoge1xyXG4gICAgICAgICAgICAgICAgdG9hc3Q6ICdkaXJlY3RpdmVzL3RvYXN0L3RvYXN0Lmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgcHJvZ3Jlc3NiYXI6ICdkaXJlY3RpdmVzL3Byb2dyZXNzYmFyL3Byb2dyZXNzYmFyLmh0bWwnXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRpbWVPdXQ6IDUwMDAsXHJcbiAgICAgICAgICAgIHRpdGxlQ2xhc3M6ICd0b2FzdC10aXRsZScsXHJcbiAgICAgICAgICAgIHRvYXN0Q2xhc3M6ICd0b2FzdCdcclxuICAgICAgICB9KTtcclxuICAgIH1dKTtcclxufSkoKTsiLCIvL3NoYXJlZC1jb21wb25lbnRzLm1vZHVsZS5qc1xyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdzaGFyZWQuY29tcG9uZW50cycsIFtdKTtcclxuICAgIH1cclxuKSgpOyIsIi8vY29uZnJtYXRpb24tbW9kYWwuY29tcG9uZW50LmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpczsgXHJcblxyXG4gICAgICAgICRjdHJsLiRvbkluaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ21vZGFsJywgJGN0cmwpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW9kdWxlLmNvbXBvbmVudCgnY29uZmlybWF0aW9uTW9kYWwnLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdGVtcGxhdGU6ICd5ZXMgb3Igbm8nLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiBbY29udHJvbGxlcl1cclxuICAgICAgICB9KTtcclxufVxyXG4pKCk7IiwiLy9wdWJsaXNoZXItbGlzdC5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ3NoYXJlZC5jb21wb25lbnRzJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcigkaHR0cCwgJHVpYk1vZGFsKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJGh0dHAuZ2V0KCdhcGkvcHVibGlzaGVyJykudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwucHVibGlzaGVycyA9IHIuZGF0YTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmNyZWF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHVpYk1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiAncHVibGlzaGVyRWRpdCcsXHJcbiAgICAgICAgICAgICAgICBiaW5kaW5nczoge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2U6IFwiPFwiXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogJ2xnJ1xyXG4gICAgICAgICAgICB9KS5yZXN1bHQudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8oXCJJIHdhcyBjbG9zZWQsIHNvIGRvIHdoYXQgSSBuZWVkIHRvIGRvIG15Q29udGVudCdzIGNvbnRyb2xsZXIgbm93LiAgUmVzdWx0IHdhcy0+XCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5pbmZvKCdyZXR1cm5pbmcgcmVzdWx0JywgcmVzdWx0KTtcclxuICAgICAgICAgICAgICAgICRjdHJsLnB1Ymxpc2hlcnMudW5zaGlmdChyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuaWQgPSByZXN1bHQuaWQ7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhcIkkgd2FzIGRpbWlzc2VkLCBzbyBkbyB3aGF0IEkgbmVlZCB0byBkbyBteUNvbnRlbnQncyBjb250cm9sbGVyIG5vdy4gIFJlYXNvbiB3YXMtPlwiICsgcmVhc29uKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5lZGl0ID0gZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgJHVpYk1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiAncHVibGlzaGVyRWRpdCcsXHJcbiAgICAgICAgICAgICAgICBiaW5kaW5nczoge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2U6IFwiPFwiXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiAkY3RybC5pZFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNpemU6ICdsZydcclxuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKCRjdHJsLnB1Ymxpc2hlcnMsIGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uaWQgPT09ICRjdHJsLmlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKGl0ZW0sIHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRjdHJsLmlkID0gaXRlbS5pZDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhcIkkgd2FzIGRpbWlzc2VkLCBzbyBkbyB3aGF0IEkgbmVlZCB0byBkbyBteUNvbnRlbnQncyBjb250cm9sbGVyIG5vdy4gIFJlYXNvbiB3YXMtPlwiICsgcmVhc29uKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3B1Ymxpc2hlclNlbGVjdCcsXHJcbiAgICB7XHJcbiAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgaWQ6ICc9J1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvY29tbW9uL3B1Ymxpc2hlci1zZWxlY3QuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgICAgIGNvbnRyb2xsZXI6IFsnJGh0dHAnLCAnJHVpYk1vZGFsJywgY29udHJvbGxlcl1cclxuICAgIH0pO1xyXG5cclxuXHJcbn1cclxuKSgpOyIsIi8vZGlyZWN0aXZlcy5tb2R1bGVzLmpzXHJcbihmdW5jdGlvbigpIHtcclxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAuZGlyZWN0aXZlcycsIFtdKTsgXHJcbn0pKCk7IiwiLy9zdFRhYmxlLmRpcmVjdGl2ZS5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwLmRpcmVjdGl2ZXMnKTtcclxuXHJcbiAgICBtb2R1bGUuZGlyZWN0aXZlKCdzdFN1Ym1pdFNlYXJjaCcsIFsnc3RDb25maWcnLCAnJHRpbWVvdXQnLCAnJHBhcnNlJywgZnVuY3Rpb24gKHN0Q29uZmlnLCAkdGltZW91dCwgJHBhcnNlKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVxdWlyZTogJ15zdFRhYmxlJyxcclxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudC5iaW5kKCdjbGljaycsXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFibGVDdHJsID0gY3RybDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnBpcGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfV0pO1xyXG5cclxuICAgIG1vZHVsZS5kaXJlY3RpdmUoXCJjbGVhcktleVwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFQScsXHJcbiAgICAgICAgICAgIHJlcXVpcmU6ICduZ01vZGVsJyxcclxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbCwgYXR0cnMsIGN0cmwpIHtcclxuICAgICAgICAgICAgICAgIGVsLm9uKCdrZXlkb3duJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LndoaWNoICE9PSAyNykgeyByZXR1cm47IH0gLy8gY2hlY2sga2V5IGhvdyB5b3Ugd2FudFxyXG4gICAgICAgICAgICAgICAgICAgIGN0cmwuJHNldFZpZXdWYWx1ZShudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICBjdHJsLiRyZW5kZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICBtb2R1bGUuZGlyZWN0aXZlKFwic3RSZXNldFNlYXJjaFwiLFxyXG4gICAgICAgICAgICBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3RyaWN0OiAnRUEnLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmU6IFsnXnN0VGFibGUnLCAnXm5nTW9kZWwnXSxcclxuICAgICAgICAgICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBjdHJscykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudC5iaW5kKCdjbGljaycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vZGVsID0gY3RybHNbMV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN0cmwgPSBjdHJsc1swXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChtb2RlbC4kdmlld1ZhbHVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoa2V5LnRvTG93ZXJDYXNlKCkgPT09ICdwYWdlJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC4kdmlld1ZhbHVlW2tleV0gPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkgfHwgXy5pbmNsdWRlcyhrZXkudG9Mb3dlckNhc2UoKSwgJ3BhZ2UnKSkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLiR2aWV3VmFsdWVba2V5XSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlU3RhdGUgPSBjdHJsLnRhYmxlU3RhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVTdGF0ZS5zZWFyY2gucHJlZGljYXRlT2JqZWN0ID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlU3RhdGUucGFnaW5hdGlvbi5zdGFydCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjdHJsLnBpcGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgIG1vZHVsZS5kaXJlY3RpdmUoXCJzdENsZWFyS2V5XCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZXN0cmljdDogJ0VBJyxcclxuICAgICAgICAgICAgcmVxdWlyZTogWydec3RUYWJsZScsICdebmdNb2RlbCddLFxyXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBjdHJscykge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5vbigna2V5ZG93bicsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZ01vZGVsID0gY3RybHNbMV07XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN0cmwgPSBjdHJsc1swXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LndoaWNoID09PSAxMykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3RybC5waXBlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC53aGljaCA9PT0gMjcpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LmNvbnRleHQuYXR0cmlidXRlc1snc3Qtc2VhcmNoJ10gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpZWxkTmFtZSA9IGVsZW1lbnQuY29udGV4dC5hdHRyaWJ1dGVzWydzdC1zZWFyY2gnXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFibGVTdGF0ZSA9IGN0cmwudGFibGVTdGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlU3RhdGUuc2VhcmNoLnByZWRpY2F0ZU9iamVjdFtmaWVsZE5hbWVdID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGN0cmwucGlwZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmdNb2RlbC4kc2V0Vmlld1ZhbHVlKG51bGwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5nTW9kZWwuJHJlbmRlcigpOyAvLyB3aWxsIHVwZGF0ZSB0aGUgaW5wdXQgdmFsdWUgYXMgd2VsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcblxyXG59XHJcbikoKTsiLCIvL3Byb2R1Y3QtZWRpdC5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcihzZXJ2aWNlKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuXHJcbiAgICAgICAgJGN0cmwuZGF0ZU9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgIGRhdGVEaXNhYmxlZDogZmFsc2UsXHJcbiAgICAgICAgICAgIGZvcm1hdFllYXI6ICd5eSdcclxuICAgICAgICB9O1xyXG4gICAgICAgICRjdHJsLmRhdGVGb3JtYXQgPSBcIk1NL0REL1lZWVlcIjtcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJGN0cmwudGl0bGUgPSAnTmV3IFByb2R1Y3QnO1xyXG4gICAgICAgICAgICBpZiAoJGN0cmwucmVzb2x2ZSkge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuaWQgPSAkY3RybC5yZXNvbHZlLmlkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICgkY3RybC5pZCkge1xyXG4gICAgICAgICAgICAgICAgc2VydmljZS5nZXRQcm9kdWN0KCRjdHJsLmlkKS50aGVuKGZ1bmN0aW9uIChyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJGN0cmwucHJvZHVjdCA9IHI7XHJcbiAgICAgICAgICAgICAgICAgICAgJGN0cmwudGl0bGUgPSByLnRpdGxlO1xyXG4gICAgICAgICAgICAgICAgICAgICRjdHJsLnByb2R1Y3QucmVjZWlwdERhdGUgPSBuZXcgRGF0ZShyLnJlY2VpcHREYXRlKTsgXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkY3RybC5kaXNtaXNzKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5zYXZlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gc2VydmljZS5zYXZlKCRjdHJsLnByb2R1Y3QpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKCRjdHJsLnByb2R1Y3QsIHIpO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwubW9kYWxJbnN0YW5jZS5jbG9zZSgkY3RybC5wcm9kdWN0KTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yIHNhdmluZyBwcm9kdWN0JywgZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9KS5maW5hbGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuY29tcG9uZW50KCdwcm9kdWN0RWRpdCcsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9wcm9kdWN0L3Byb2R1Y3QtZWRpdC5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICBpZDogJzwnLFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZTogJzwnLFxyXG4gICAgICAgICAgICAgICAgY2xvc2U6ICcmJyxcclxuICAgICAgICAgICAgICAgIGRpc21pc3M6ICcmJyxcclxuICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2U6ICc8J1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiBbJ1Byb2R1Y3QnLCBjb250cm9sbGVyXVxyXG4gICAgICAgIH0pO1xyXG59KSgpO1xyXG4iLCIvL3Byb2R1Y3QtbGlzdC5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoJG1vZGFsLCAkbmdDb25maXJtLCB0b2FzdHIsIHByb2R1Y3QpIHtcclxuICAgICAgICB2YXIgJGN0cmwgPSB0aGlzO1xyXG4gICAgICAgIHZhciBwYWdlU2l6ZURlZmF1bHQgPSAxMDtcclxuICAgICAgICB2YXIgdGFibGVTdGF0ZVJlZjtcclxuXHJcbiAgICAgICAgJGN0cmwuc2VhcmNoTW9kZWwgPSB7XHJcbiAgICAgICAgICAgIHBhZ2U6IDEsXHJcbiAgICAgICAgICAgIHBhZ2VTaXplOiBwYWdlU2l6ZURlZmF1bHQsIFxyXG4gICAgICAgICAgICBmaWx0ZXJlZENvdW50OiAwLCBcclxuICAgICAgICAgICAgdG90YWxDb3VudDogMCwgXHJcbiAgICAgICAgICAgIHRvdGFsUGFnZXM6IDBcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkY3RybC4kb25Jbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygncHJvZHVjdCBsaXN0IGluaXQnKTtcclxuICAgICAgICAgICAgJGN0cmwudGl0bGUgPSAnTWVkaWEgTGlicmFyeSc7XHJcbiAgICAgICAgICAgICRjdHJsLmxvYWRpbmcgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuc2VhcmNoID0gZnVuY3Rpb24gKHRhYmxlU3RhdGUpIHtcclxuICAgICAgICAgICAgJGN0cmwubG9hZGluZyA9IHRydWU7XHJcbiAgICAgICAgICAgIHRhYmxlU3RhdGVSZWYgPSB0YWJsZVN0YXRlO1xyXG4gICAgICAgICAgICBwcm9kdWN0LmdldEFsbFByb2R1Y3RzKCRjdHJsLnNlYXJjaE1vZGVsKS50aGVuKGZ1bmN0aW9uIChyKSB7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5wcm9kdWN0cyA9IHIucmVzdWx0cztcclxuICAgICAgICAgICAgICAgICRjdHJsLnNlYXJjaE1vZGVsID0gcjtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSAkY3RybC5zZWFyY2hNb2RlbC5yZXN1bHRzO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwubG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnBhZ2VkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkY3RybC5zZWFyY2godGFibGVTdGF0ZVJlZik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5jcmVhdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRtb2RhbC5vcGVuKHtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudDogJ3Byb2R1Y3RFZGl0JyxcclxuICAgICAgICAgICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kYWxJbnN0YW5jZTogXCI8XCJcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzaXplOiAnbWQnXHJcbiAgICAgICAgICAgIH0pLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICRjdHJsLnByb2R1Y3RzLnVuc2hpZnQocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIHRvYXN0ci5pbmZvKCdDcmVhdGVkICcgKyByZXN1bHQudGl0bGUpO1xyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8oXCJJIHdhcyBkaW1pc3NlZCwgc28gZG8gd2hhdCBJIG5lZWQgdG8gZG8gbXlDb250ZW50J3MgY29udHJvbGxlciBub3cuICBSZWFzb24gd2FzLT5cIiArIHJlYXNvbik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuZWRpdCA9IGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICRtb2RhbC5vcGVuKHtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudDogJ3Byb2R1Y3RFZGl0JyxcclxuICAgICAgICAgICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kYWxJbnN0YW5jZTogXCI8XCJcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGl0ZW0uaWRcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzaXplOiAnbWQnXHJcbiAgICAgICAgICAgIH0pLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKGl0ZW0sIHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICB0b2FzdHIuaW5mbygnU2F2ZWQgJyArIHJlc3VsdC50aXRsZSk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5kZWxldGUgPSBmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICAkbmdDb25maXJtKHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiAnRGVsZXRlJyxcclxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIDxiciAvPjxzdHJvbmc+JyArIGl0ZW0udGl0bGUgKyAnPC9zdHJvbmc+PycsXHJcbiAgICAgICAgICAgICAgICB0eXBlOiAncmVkJyxcclxuICAgICAgICAgICAgICAgIGJ1dHRvbnM6IHtcclxuICAgICAgICAgICAgICAgICAgICB5ZXM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAga2V5czogWyd5J10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbjogZnVuY3Rpb24gKHNjb3BlLCBidXR0b24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3QucmVtb3ZlKGl0ZW0uaWQpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWR4ID0gJGN0cmwucHJvZHVjdHMuaW5kZXhPZihpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY3RybC5wcm9kdWN0cy5zcGxpY2UoaWR4LCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2FzdHIud2FybmluZygnRGVsZXRlZCAnICsgaXRlbS50aXRsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgbm86IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAga2V5czogWydOJ10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbjogZnVuY3Rpb24gKHNjb3BlLCBidXR0b24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5zaG93RGV0YWlscyA9IGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICRtb2RhbC5vcGVuKHtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudDogJ3Byb2R1Y3RTdW1tYXJ5JyxcclxuICAgICAgICAgICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kYWxJbnN0YW5jZTogXCI8XCJcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGl0ZW0uaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYXNNb2RhbDogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNpemU6ICdtZCdcclxuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5pbmZvKFwiSSB3YXMgY2xvc2VkLCBzbyBkbyB3aGF0IEkgbmVlZCB0byBkbyBteUNvbnRlbnQncyBjb250cm9sbGVyIG5vdy4gIFJlc3VsdCB3YXMtPlwiKTtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKGl0ZW0sIHJlc3VsdCk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhcIkkgd2FzIGRpbWlzc2VkLCBzbyBkbyB3aGF0IEkgbmVlZCB0byBkbyBteUNvbnRlbnQncyBjb250cm9sbGVyIG5vdy4gIFJlYXNvbiB3YXMtPlwiICsgcmVhc29uKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3Byb2R1Y3RMaXN0JyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3Byb2R1Y3QvcHJvZHVjdC1saXN0LmNvbXBvbmVudC5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogWyckdWliTW9kYWwnLCAnJG5nQ29uZmlybScsICd0b2FzdHInLCAnUHJvZHVjdCcsIGNvbnRyb2xsZXJdXHJcbiAgICAgICAgfSk7XHJcblxyXG59XHJcbikoKTsiLCIvL3Byb2R1Y3Qtc3VtbWFyeS5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcigkbW9kYWwsIHNlcnZpY2UpIHtcclxuICAgICAgICB2YXIgJGN0cmwgPSB0aGlzO1xyXG5cclxuICAgICAgICAkY3RybC4kb25Jbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkY3RybC5sb2FkaW5nID0gdHJ1ZTsgXHJcbiAgICAgICAgICAgIGlmICgkY3RybC5yZXNvbHZlKSB7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5pZCA9ICRjdHJsLnJlc29sdmUuaWQ7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5hc01vZGFsID0gJGN0cmwucmVzb2x2ZS5hc01vZGFsO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuYWRkU3RhZmZWaXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHNlcnZpY2UuZ2V0UHJvZHVjdCgkY3RybC5pZCkudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwucHJvZHVjdCA9IHI7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5sb2FkaW5nID0gZmFsc2U7IFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmVkaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJG1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiAncHJvZHVjdEVkaXQnLFxyXG4gICAgICAgICAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlOiBcIjxcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBpZDogJGN0cmwucHJvZHVjdC5pZFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNpemU6ICdtZCdcclxuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoJGN0cmwucHJvZHVjdCwgcmVzdWx0KTtcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnNob3dOZXdTdGFmZiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkbW9kYWwub3Blbih7XHJcbiAgICAgICAgICAgICAgICBjb21wb25lbnQ6ICdzdGFmZkVkaXQnLFxyXG4gICAgICAgICAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlOiBcIjxcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6ICRjdHJsLmlkXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogJ21kJ1xyXG4gICAgICAgICAgICB9KS5yZXN1bHQudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8oXCJJIHdhcyBjbG9zZWQsIHNvIGRvIHdoYXQgSSBuZWVkIHRvIGRvIG15Q29udGVudCdzIGNvbnRyb2xsZXIgbm93LiAgUmVzdWx0IHdhcy0+XCIpO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwucHJvZHVjdC5zdGFmZi51bnNoaWZ0KHJlc3VsdCk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhcIkkgd2FzIGRpbWlzc2VkLCBzbyBkbyB3aGF0IEkgbmVlZCB0byBkbyBteUNvbnRlbnQncyBjb250cm9sbGVyIG5vdy4gIFJlYXNvbiB3YXMtPlwiICsgcmVhc29uKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRjdHJsLm1vZGFsSW5zdGFuY2UuY2xvc2UoJGN0cmwucHJvZHVjdCk7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuY29tcG9uZW50KCdwcm9kdWN0U3VtbWFyeScsXHJcbiAgICB7XHJcbiAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgaWQ6ICc8JyxcclxuICAgICAgICAgICAgYXNNb2RhbDogJzwnLFxyXG4gICAgICAgICAgICByZXNvbHZlOiAnPCcsXHJcbiAgICAgICAgICAgIGNsb3NlOiAnJicsXHJcbiAgICAgICAgICAgIGRpc21pc3M6ICcmJywgXHJcbiAgICAgICAgICAgIG1vZGFsSW5zdGFuY2U6ICc8J1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvcHJvZHVjdC9wcm9kdWN0LXN1bW1hcnkuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgICAgIGNvbnRyb2xsZXI6IFsnJHVpYk1vZGFsJywgJ1Byb2R1Y3QnLCBjb250cm9sbGVyXVxyXG4gICAgfSk7XHJcblxyXG59XHJcbikoKTsiLCIvL3Byb2R1Y3Quc2VydmljZS5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnKTsgXHJcbiAgICBcclxuICAgIG1vZHVsZS5mYWN0b3J5KCdQcm9kdWN0JywgWyckaHR0cCcsIHNlcnZpY2VDb250cm9sbGVyXSk7XHJcblxyXG4gICAgZnVuY3Rpb24gc2VydmljZUNvbnRyb2xsZXIoJGh0dHApIHtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgZ2V0UHJvZHVjdDogZ2V0UHJvZHVjdCxcclxuICAgICAgICAgICAgZ2V0QWxsUHJvZHVjdHM6IGdldEFsbFByb2R1Y3RzLFxyXG4gICAgICAgICAgICByZW1vdmU6IHJlbW92ZSwgXHJcbiAgICAgICAgICAgIHNhdmU6IHNhdmVcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZXRQcm9kdWN0KGlkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJ2FwaS9wcm9kdWN0LycgKyBpZCkudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHIuZGF0YTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldEFsbFByb2R1Y3RzKHNlYXJjaE1vZGVsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJ2FwaS9wcm9kdWN0JywgeyBwYXJhbXM6IHNlYXJjaE1vZGVsIH0pLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByLmRhdGE7XHJcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVyci5tZXNzYWdlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiByZW1vdmUoaWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLmRlbGV0ZSgnYXBpL3Byb2R1Y3QvJyArIGlkKS50aGVuKGZ1bmN0aW9uKHIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByLmRhdGE7XHJcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9KTsgXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzYXZlKHByb2R1Y3QpIHtcclxuICAgICAgICAgICAgaWYgKHByb2R1Y3QuaWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAkaHR0cC5wdXQoJ2FwaS9wcm9kdWN0JywgcHJvZHVjdCkudGhlbihmdW5jdGlvbihyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHIuZGF0YTtcclxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlcnIubWVzc2FnZTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJ2FwaS9wcm9kdWN0JywgcHJvZHVjdCkudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByLmRhdGE7XHJcbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVyci5tZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxufVxyXG4pKCk7IiwiLy9zdGFmZi1lZGl0LmNvbXBvbmVudC5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnKTtcclxuXHJcbiAgICBmdW5jdGlvbiBjb250cm9sbGVyKCRodHRwKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3N0YWZmIGVkaXQgaW5pdCcpO1xyXG4gICAgICAgICAgICAkY3RybC50aXRsZSA9ICdOZXcgU3RhZmYnO1xyXG5cclxuICAgICAgICAgICAgaWYgKCRjdHJsLnJlc29sdmUpICRjdHJsLnByb2R1Y3RJZCA9ICRjdHJsLnJlc29sdmUucHJvZHVjdElkO1xyXG5cclxuICAgICAgICAgICAgaWYgKCRjdHJsLnJlc29sdmUuc3RhZmYpIHtcclxuICAgICAgICAgICAgICAgICRjdHJsLnN0YWZmID0gJGN0cmwucmVzb2x2ZS5zdGFmZjtcclxuICAgICAgICAgICAgICAgICRjdHJsLnRpdGxlID0gJGN0cmwuc3RhZmYuZmlyc3RuYW1lICsgJyAnICsgJGN0cmwuc3RhZmYubGFzdG5hbWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJGN0cmwuZGlzbWlzcygpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRjdHJsLnNhdmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICgkY3RybC5wcm9kdWN0SWQpIHtcclxuICAgICAgICAgICAgICAgICRodHRwLnBvc3QoJ2FwaS9zdGFmZi8nICsgJGN0cmwucHJvZHVjdElkLCAkY3RybC5zdGFmZikudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKCRjdHJsLnN0YWZmLCByLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICRjdHJsLm1vZGFsSW5zdGFuY2UuY2xvc2Uoci5kYXRhKTtcclxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc29tZXRoaW5nIHdlbnQgd3JvbmcnLCBlcnIubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICRodHRwLnBvc3QoJ2FwaS9zdGFmZicsICRjdHJsLnN0YWZmKS50aGVuKGZ1bmN0aW9uIChyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoJGN0cmwuc3RhZmYsIHIuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJGN0cmwubW9kYWxJbnN0YW5jZS5jbG9zZShyLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzb21ldGhpbmcgd2VudCB3cm9uZycsIGVyci5tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuY29tcG9uZW50KCdzdGFmZkVkaXQnLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6ICc8JyxcclxuICAgICAgICAgICAgICAgIGNsb3NlOiAnJicsXHJcbiAgICAgICAgICAgICAgICBkaXNtaXNzOiAnJicsXHJcbiAgICAgICAgICAgICAgICBzdGFmZjogJzwnLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiAnPCcsXHJcbiAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlOiAnPCdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvc3RhZmYvc3RhZmYtZWRpdC5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJGh0dHAnLCBjb250cm9sbGVyXVxyXG4gICAgICAgIH0pO1xyXG59XHJcbikoKTsiLCIvL3N0YWZmLWxpc3QuY29tcG9uZW50LmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoJGh0dHAsICRtb2RhbCwgJG5nQ29uZmlybSkge1xyXG4gICAgICAgIHZhciAkY3RybCA9IHRoaXM7XHJcblxyXG4gICAgICAgICRjdHJsLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzdGFmZiBsaXN0IGluaXQnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmVkaXQgPSBmdW5jdGlvbiAobWVtYmVyKSB7XHJcbiAgICAgICAgICAgICRtb2RhbC5vcGVuKHtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudDogJ3N0YWZmRWRpdCcsXHJcbiAgICAgICAgICAgICAgICBiaW5kaW5nczoge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2U6IFwiPFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHN0YWZmOiBtZW1iZXJcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RhZmY6IG1lbWJlclxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNpemU6ICdtZCdcclxuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5pbmZvKFwiSSB3YXMgY2xvc2VkLCBzbyBkbyB3aGF0IEkgbmVlZCB0byBkbyBteUNvbnRlbnQncyBjb250cm9sbGVyIG5vdy4gIFJlc3VsdCB3YXMtPlwiKTtcclxuXHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhcIkkgd2FzIGRpbWlzc2VkLCBzbyBkbyB3aGF0IEkgbmVlZCB0byBkbyBteUNvbnRlbnQncyBjb250cm9sbGVyIG5vdy4gIFJlYXNvbiB3YXMtPlwiICsgcmVhc29uKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5kZWxldGUgPSBmdW5jdGlvbiAobWVtYmVyKSB7XHJcbiAgICAgICAgICAgICRuZ0NvbmZpcm0oe1xyXG4gICAgICAgICAgICAgICAgdGl0bGU6ICdEZWxldGUnLFxyXG4gICAgICAgICAgICAgICAgY29udGVudDogJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgPGJyIC8+PHN0cm9uZz4nICsgbWVtYmVyLmZpcnN0bmFtZSArIG1lbWJlci5sYXN0bmFtZSArICc8L3N0cm9uZz4/JyxcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdyZWQnLFxyXG4gICAgICAgICAgICAgICAgYnV0dG9uczoge1xyXG4gICAgICAgICAgICAgICAgICAgIHllczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXlzOiBbJ3knXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBmdW5jdGlvbiAoc2NvcGUsIGJ1dHRvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGh0dHAuZGVsZXRlKCdhcGkvc3RhZmYvJyArIG1lbWJlci5pZCkudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZHggPSAkY3RybC5zdGFmZi5pbmRleE9mKG1lbWJlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGN0cmwuc3RhZmYuc3BsaWNlKGlkeCwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Vycm9yJywgZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIG5vOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleXM6IFsnTiddLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb246IGZ1bmN0aW9uIChzY29wZSwgYnV0dG9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3N0YWZmTGlzdCcsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiaW5kaW5nczoge1xyXG4gICAgICAgICAgICAgICAgc3RhZmY6ICc8J1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9zdGFmZi9zdGFmZi1saXN0LmNvbXBvbmVudC5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogWyckaHR0cCcsICckdWliTW9kYWwnLCAnJG5nQ29uZmlybScsIGNvbnRyb2xsZXJdXHJcbiAgICAgICAgfSk7XHJcbn1cclxuKSgpOyJdfQ==
