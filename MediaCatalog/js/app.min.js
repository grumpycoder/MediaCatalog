!function(){"use strict";var t=angular.module("app",["ngStorage","app.directives","shared.components","ui.bootstrap","smart-table","cp.ngConfirm","treasure-overlay-spinner","toastr"]);t.config(["toastrConfig",function(t){angular.extend(t,{positionClass:"toast-bottom-right",newestOnTop:!0,allowHtml:!1,closeButton:!1,closeHtml:"<button>&times;</button>",extendedTimeOut:1e3,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},messageClass:"toast-message",onHidden:null,onShown:null,onTap:null,progressBar:!1,tapToDismiss:!0,templates:{toast:"directives/toast/toast.html",progressbar:"directives/progressbar/progressbar.html"},timeOut:5e3,titleClass:"toast-title",toastClass:"toast"})}])}();
!function(){angular.module("shared.components",[])}();
!function(){function n(){var n=this;n.$onInit=function(){console.log("modal",n)}}var o=angular.module("app");o.component("confirmationModal",{bindings:{},template:"yes or no",controller:[n]})}();
!function(){function n(n,o){var e=this;e.$onInit=function(){n.get("api/publisher").then(function(n){e.publishers=n.data}).catch(function(n){console.log(n.message)})},e.create=function(){o.open({component:"publisherEdit",bindings:{modalInstance:"<"},size:"lg"}).result.then(function(n){console.info("I was closed, so do what I need to do myContent's controller now.  Result was->"),console.info("returning result",n),e.publishers.unshift(n),e.id=n.id},function(n){console.info("I was dimissed, so do what I need to do myContent's controller now.  Reason was->"+n)})},e.edit=function(){o.open({component:"publisherEdit",bindings:{modalInstance:"<"},resolve:{id:e.id},size:"lg"}).result.then(function(n){angular.forEach(e.publishers,function(o){o.id===e.id&&(angular.extend(o,n),e.id=o.id)})},function(n){console.info("I was dimissed, so do what I need to do myContent's controller now.  Reason was->"+n)})}}var o=angular.module("shared.components");o.component("publisherSelect",{bindings:{id:"="},templateUrl:"app/common/publisher-select.component.html",controller:["$http","$uibModal",n]})}();
!function(){angular.module("app.directives",[])}();
!function(){var e=angular.module("app.directives");e.directive("stSubmitSearch",["stConfig","$timeout","$parse",function(e,t,r){return{require:"^stTable",link:function(e,t,r,n){return t.bind("click",function(){var e=n;e.pipe()})}}}]),e.directive("clearKey",function(){return{restrict:"EA",require:"ngModel",link:function(e,t,r,n){t.on("keydown",function(t){27===t.which&&(n.$setViewValue(null),n.$render(),e.$apply())})}}}),e.directive("stResetSearch",function(){return{restrict:"EA",require:["^stTable","^ngModel"],link:function(e,t,r,n){return t.bind("click",function(){var t=n[1],r=n[0];return e.$apply(function(){angular.forEach(t.$viewValue,function(e,r){"page"===r.toLowerCase()&&(t.$viewValue[r]=1),Array.isArray(e)||_.includes(r.toLowerCase(),"page")||(t.$viewValue[r]=null)});var e=r.tableState();return e.search.predicateObject={},e.pagination.start=0,r.pipe()})})}}}),e.directive("stClearKey",function(){return{restrict:"EA",require:["^stTable","^ngModel"],link:function(e,t,r,n){t.on("keydown",function(r){var i=n[1],a=n[0];return 13===r.which?a.pipe():27===r.which?void 0!==t.context.attributes["st-search"]?e.$apply(function(){var e=t.context.attributes["st-search"].value,r=a.tableState();return r.search.predicateObject[e]="",a.pipe()}):e.$apply(function(){i.$setViewValue(null),i.$render()}):void 0})}}})}();
!function(){function t(t){var n=this;n.$onInit=function(){n.title="New Product",n.resolve&&(n.id=n.resolve.id),n.id&&t.getProduct(n.id).then(function(t){n.product=t,n.title=t.title})},n.cancel=function(){n.dismiss()},n.save=function(){return t.save(n.product).then(function(t){angular.extend(n.product,t),n.modalInstance.close(n.product)}).catch(function(t){console.log("Error saving product",t.message)}).finally(function(){})}}var n=angular.module("app");n.component("productEdit",{templateUrl:"app/product/product-edit.component.html",bindings:{id:"<",resolve:"<",close:"&",dismiss:"&",modalInstance:"<"},controller:["Product",t]})}();
!function(){"use strict";function n(n,o,t,e){var i,s=this,c=10;s.searchModel={page:1,pageSize:c},s.$onInit=function(){console.log("product list init"),s.title="Product List",s.loading=!0},s.search=function(n){s.loading=!0,i=n,console.log("search"),e.getAllProducts(s.searchModel).then(function(n){s.products=n.results,s.searchModel=n,delete s.searchModel.results,s.loading=!1}).catch(function(n){s.loading=!1}).finally(function(){})},s.paged=function(){s.search(i)},s.create=function(){n.open({component:"productEdit",bindings:{modalInstance:"<"},size:"md"}).result.then(function(n){s.products.unshift(n),t.info("Created "+n.title)},function(n){console.info("I was dimissed, so do what I need to do myContent's controller now.  Reason was->"+n)})},s.edit=function(o){n.open({component:"productEdit",bindings:{modalInstance:"<"},resolve:{id:o.id},size:"md"}).result.then(function(n){angular.extend(o,n),t.info("Saved "+n.title)},function(n){})},s.delete=function(n){o({title:"Delete",content:"Are you sure you want to delete <br /><strong>"+n.title+"</strong>?",type:"red",buttons:{yes:{keys:["y"],action:function(o,i){e.remove(n.id).then(function(o){var e=s.products.indexOf(n);s.products.splice(e,1),t.warning("Deleted "+n.title)})}},no:{keys:["N"],action:function(n,o){}}}})},s.showDetails=function(o){n.open({component:"productSummary",bindings:{modalInstance:"<"},resolve:{id:o.id,asModal:!0},size:"md"}).result.then(function(n){console.info("I was closed, so do what I need to do myContent's controller now.  Result was->"),angular.extend(o,n)},function(n){console.info("I was dimissed, so do what I need to do myContent's controller now.  Reason was->"+n)})}}var o=angular.module("app");o.component("productList",{templateUrl:"app/product/product-list.component.html",controller:["$uibModal","$ngConfirm","toastr","Product",n]})}();
!function(){function o(o,n){var t=this;t.$onInit=function(){t.resolve&&(t.id=t.resolve.id,t.asModal=t.resolve.asModal,t.addStaffVisible=!1),n.getProduct(t.id).then(function(o){t.product=o})},t.edit=function(){o.open({component:"productEdit",bindings:{modalInstance:"<"},resolve:{id:t.product.id},size:"md"}).result.then(function(o){angular.extend(t.product,o)},function(o){})},t.showNewStaff=function(){o.open({component:"staffEdit",bindings:{modalInstance:"<"},resolve:{productId:t.id},size:"md"}).result.then(function(o){console.info("I was closed, so do what I need to do myContent's controller now.  Result was->"),t.product.staff.unshift(o)},function(o){console.info("I was dimissed, so do what I need to do myContent's controller now.  Reason was->"+o)})},t.cancel=function(){t.modalInstance.close(t.product)}}var n=angular.module("app");n.component("productSummary",{bindings:{id:"<",asModal:"<",resolve:"<",close:"&",dismiss:"&",modalInstance:"<"},templateUrl:"app/product/product-summary.component.html",controller:["$uibModal","Product",o]})}();
!function(){"use strict";function t(t){function n(n){return t.get("api/product/"+n).then(function(t){return t.data}).catch(function(t){console.log(t.message)})}function e(n){return t.get("api/product",{params:n}).then(function(t){return t.data}).catch(function(t){console.log(t.message)})}function u(n){return t.delete("api/product/"+n).then(function(t){return t.data}).catch(function(t){console.log(t.message)})}function c(n){return n.id?t.put("api/product",n).then(function(t){return t.data}).catch(function(t){return t.message}):t.post("api/product",n).then(function(t){return t.data}).catch(function(t){return t.message})}return{getProduct:n,getAllProducts:e,remove:u,save:c}}var n=angular.module("app");n.factory("Product",["$http",t])}();
!function(){function t(t){var a=this;a.$onInit=function(){console.log("staff edit init"),a.title="New Staff",a.resolve&&(a.productId=a.resolve.productId),a.resolve.staff&&(a.staff=a.resolve.staff,a.title=a.staff.firstname+" "+a.staff.lastname)},a.cancel=function(){a.dismiss()},a.save=function(){a.productId?t.post("api/staff/"+a.productId,a.staff).then(function(t){angular.extend(a.staff,t.data),a.modalInstance.close(t.data)}).catch(function(t){console.log("something went wrong",t.message)}):t.post("api/staff",a.staff).then(function(t){angular.extend(a.staff,t.data),a.modalInstance.close(t.data)}).catch(function(t){console.log("something went wrong",t.message)})}}var a=angular.module("app");a.component("staffEdit",{bindings:{resolve:"<",close:"&",dismiss:"&",staff:"<",productId:"<",modalInstance:"<"},templateUrl:"app/staff/staff-edit.component.html",controller:["$http",t]})}();
!function(){function t(t,n,o){var e=this;e.$onInit=function(){console.log("staff list init")},e.edit=function(t){n.open({component:"staffEdit",bindings:{modalInstance:"<",staff:t},resolve:{staff:t},size:"md"}).result.then(function(t){console.info("I was closed, so do what I need to do myContent's controller now.  Result was->")},function(t){console.info("I was dimissed, so do what I need to do myContent's controller now.  Reason was->"+t)})},e.delete=function(n){o({title:"Delete",content:"Are you sure you want to delete <br /><strong>"+n.firstname+n.lastname+"</strong>?",type:"red",buttons:{yes:{keys:["y"],action:function(o,s){t.delete("api/staff/"+n.id).then(function(t){var o=e.staff.indexOf(n);e.staff.splice(o,1)}).catch(function(t){console.log("error",t.message)})}},no:{keys:["N"],action:function(t,n){}}}})}}var n=angular.module("app");n.component("staffList",{bindings:{staff:"<"},templateUrl:"app/staff/staff-list.component.html",controller:["$http","$uibModal","$ngConfirm",t]})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJjb21tb24vY29tcG9uZW50cy5tb2R1bGUuanMiLCJjb21tb24vY29uZnJtYXRpb24tbW9kYWwuY29tcG9uZW50LmpzIiwiY29tbW9uL3B1Ymxpc2hlci1zZWxlY3QuY29tcG9uZW50LmpzIiwiZGlyZWN0aXZlcy9kaXJlY3RpdmVzLm1vZHVsZXMuanMiLCJkaXJlY3RpdmVzL3N0VGFibGUuZGlyZWN0aXZlLmpzIiwicHJvZHVjdC9wcm9kdWN0LWVkaXQuY29tcG9uZW50LmpzIiwicHJvZHVjdC9wcm9kdWN0LWxpc3QuY29tcG9uZW50LmpzIiwicHJvZHVjdC9wcm9kdWN0LXN1bW1hcnkuY29tcG9uZW50LmpzIiwic2VydmljZXMvcHJvZHVjdC5zZXJ2aWNlLmpzIiwic3RhZmYvc3RhZmYtZWRpdC5jb21wb25lbnQuanMiLCJzdGFmZi9zdGFmZi1saXN0LmNvbXBvbmVudC5qcyJdLCJuYW1lcyI6WyJtb2R1bGUiLCJhbmd1bGFyIiwiY29uZmlnIiwidG9hc3RyQ29uZmlnIiwiZXh0ZW5kIiwicG9zaXRpb25DbGFzcyIsIm5ld2VzdE9uVG9wIiwiYWxsb3dIdG1sIiwiY2xvc2VCdXR0b24iLCJjbG9zZUh0bWwiLCJleHRlbmRlZFRpbWVPdXQiLCJpY29uQ2xhc3NlcyIsImVycm9yIiwiaW5mbyIsInN1Y2Nlc3MiLCJ3YXJuaW5nIiwibWVzc2FnZUNsYXNzIiwib25IaWRkZW4iLCJvblNob3duIiwib25UYXAiLCJwcm9ncmVzc0JhciIsInRhcFRvRGlzbWlzcyIsInRlbXBsYXRlcyIsInRvYXN0IiwicHJvZ3Jlc3NiYXIiLCJ0aW1lT3V0IiwidGl0bGVDbGFzcyIsInRvYXN0Q2xhc3MiLCJjb250cm9sbGVyIiwiJGN0cmwiLCJ0aGlzIiwiJG9uSW5pdCIsImNvbnNvbGUiLCJsb2ciLCJjb21wb25lbnQiLCJiaW5kaW5ncyIsInRlbXBsYXRlIiwiJGh0dHAiLCIkdWliTW9kYWwiLCJnZXQiLCJ0aGVuIiwiciIsInB1Ymxpc2hlcnMiLCJkYXRhIiwiY2F0Y2giLCJlcnIiLCJtZXNzYWdlIiwiY3JlYXRlIiwib3BlbiIsIm1vZGFsSW5zdGFuY2UiLCJzaXplIiwicmVzdWx0IiwidW5zaGlmdCIsImlkIiwicmVhc29uIiwiZWRpdCIsInJlc29sdmUiLCJmb3JFYWNoIiwiaXRlbSIsInRlbXBsYXRlVXJsIiwiZGlyZWN0aXZlIiwic3RDb25maWciLCIkdGltZW91dCIsIiRwYXJzZSIsInJlcXVpcmUiLCJsaW5rIiwic2NvcGUiLCJlbGVtZW50IiwiYXR0ciIsImN0cmwiLCJiaW5kIiwidGFibGVDdHJsIiwicGlwZSIsInJlc3RyaWN0IiwiZWwiLCJhdHRycyIsIm9uIiwiZXZlbnQiLCJ3aGljaCIsIiRzZXRWaWV3VmFsdWUiLCIkcmVuZGVyIiwiJGFwcGx5IiwiY3RybHMiLCJtb2RlbCIsIiR2aWV3VmFsdWUiLCJ2YWx1ZSIsImtleSIsInRvTG93ZXJDYXNlIiwiQXJyYXkiLCJpc0FycmF5IiwiXyIsImluY2x1ZGVzIiwidGFibGVTdGF0ZSIsInNlYXJjaCIsInByZWRpY2F0ZU9iamVjdCIsInBhZ2luYXRpb24iLCJzdGFydCIsIm5nTW9kZWwiLCJ1bmRlZmluZWQiLCJjb250ZXh0IiwiYXR0cmlidXRlcyIsImZpZWxkTmFtZSIsInNlcnZpY2UiLCJ0aXRsZSIsImdldFByb2R1Y3QiLCJwcm9kdWN0IiwiY2FuY2VsIiwiZGlzbWlzcyIsInNhdmUiLCJjbG9zZSIsImZpbmFsbHkiLCIkbW9kYWwiLCIkbmdDb25maXJtIiwidG9hc3RyIiwidGFibGVTdGF0ZVJlZiIsInBhZ2VTaXplRGVmYXVsdCIsInNlYXJjaE1vZGVsIiwicGFnZSIsInBhZ2VTaXplIiwibG9hZGluZyIsImdldEFsbFByb2R1Y3RzIiwicHJvZHVjdHMiLCJyZXN1bHRzIiwicGFnZWQiLCJkZWxldGUiLCJjb250ZW50IiwidHlwZSIsImJ1dHRvbnMiLCJ5ZXMiLCJrZXlzIiwiYWN0aW9uIiwiYnV0dG9uIiwicmVtb3ZlIiwiaWR4IiwiaW5kZXhPZiIsInNwbGljZSIsIm5vIiwic2hvd0RldGFpbHMiLCJhc01vZGFsIiwiYWRkU3RhZmZWaXNpYmxlIiwic2hvd05ld1N0YWZmIiwicHJvZHVjdElkIiwic3RhZmYiLCJzZXJ2aWNlQ29udHJvbGxlciIsInBhcmFtcyIsInB1dCIsInBvc3QiLCJmYWN0b3J5IiwiZmlyc3RuYW1lIiwibGFzdG5hbWUiLCJtZW1iZXIiXSwibWFwcGluZ3MiOiJDQUNBLFdBQ0ksWUFFQSxJQUFJQSxHQUFTQyxRQUFRRCxPQUFPLE9BRXhCLFlBQ0EsaUJBQ0Esb0JBQ0EsZUFDQSxjQUNBLGVBQ0EsMkJBQ0EsVUFHSkEsR0FBT0UsUUFBUSxlQUFnQixTQUFVQyxHQUNyQ0YsUUFBUUcsT0FBT0QsR0FDWEUsY0FBZSxxQkFDZkMsYUFBYSxFQUNiQyxXQUFXLEVBQ1hDLGFBQWEsRUFDYkMsVUFBVywyQkFDWEMsZ0JBQWlCLElBQ2pCQyxhQUNJQyxNQUFPLGNBQ1BDLEtBQU0sYUFDTkMsUUFBUyxnQkFDVEMsUUFBUyxpQkFFYkMsYUFBYyxnQkFDZEMsU0FBVSxLQUNWQyxRQUFTLEtBQ1RDLE1BQU8sS0FDUEMsYUFBYSxFQUNiQyxjQUFjLEVBQ2RDLFdBQ0lDLE1BQU8sOEJBQ1BDLFlBQWEsMkNBRWpCQyxRQUFTLElBQ1RDLFdBQVksY0FDWkMsV0FBWTtDQ3pDeEIsV0FDcUIxQixRQUFRRCxPQUFPO0NDRHBDLFdBR0ksUUFBUzRCLEtBQ0wsR0FBSUMsR0FBUUMsSUFFWkQsR0FBTUUsUUFBVSxXQUNaQyxRQUFRQyxJQUFJLFFBQVNKLElBTjdCLEdBQUk3QixHQUFTQyxRQUFRRCxPQUFPLE1BVzVCQSxHQUFPa0MsVUFBVSxxQkFFVEMsWUFFQUMsU0FBVSxZQUNWUixZQUFhQTtDQ2pCekIsV0FJSSxRQUFTQSxHQUFXUyxFQUFPQyxHQUN2QixHQUFJVCxHQUFRQyxJQUVaRCxHQUFNRSxRQUFVLFdBQ1pNLEVBQU1FLElBQUksaUJBQWlCQyxLQUFLLFNBQVVDLEdBQ3RDWixFQUFNYSxXQUFhRCxFQUFFRSxPQUN0QkMsTUFBTSxTQUFVQyxHQUNmYixRQUFRQyxJQUFJ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MEYsSUFDSVAsTUFBTyxLQUNQQyxPQUFRLFNBQVVoRSxFQUFPaUUsVUEvQzdDLEdBQUluSSxHQUFTQyxRQUFRRCxPQUFPLE1BeUQ1QkEsR0FBT2tDLFVBQVUsYUFFVEMsVUFDSTJHLE1BQU8sS0FFWG5GLFlBQWEsc0NBQ2IvQixZQUFhLFFBQVMsWUFBYSxhQUFjQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy9hcHAubW9kdWxlLmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnLFxyXG4gICAgW1xyXG4gICAgICAgICduZ1N0b3JhZ2UnLFxyXG4gICAgICAgICdhcHAuZGlyZWN0aXZlcycsXHJcbiAgICAgICAgJ3NoYXJlZC5jb21wb25lbnRzJyxcclxuICAgICAgICAndWkuYm9vdHN0cmFwJyxcclxuICAgICAgICAnc21hcnQtdGFibGUnLFxyXG4gICAgICAgICdjcC5uZ0NvbmZpcm0nLCBcclxuICAgICAgICAndHJlYXN1cmUtb3ZlcmxheS1zcGlubmVyJywgXHJcbiAgICAgICAgJ3RvYXN0cidcclxuICAgICAgICBdKTtcclxuXHJcbiAgICBtb2R1bGUuY29uZmlnKFsndG9hc3RyQ29uZmlnJywgZnVuY3Rpb24gKHRvYXN0ckNvbmZpZykge1xyXG4gICAgICAgIGFuZ3VsYXIuZXh0ZW5kKHRvYXN0ckNvbmZpZywge1xyXG4gICAgICAgICAgICBwb3NpdGlvbkNsYXNzOiAndG9hc3QtYm90dG9tLXJpZ2h0JyxcclxuICAgICAgICAgICAgbmV3ZXN0T25Ub3A6IHRydWUsXHJcbiAgICAgICAgICAgIGFsbG93SHRtbDogZmFsc2UsXHJcbiAgICAgICAgICAgIGNsb3NlQnV0dG9uOiBmYWxzZSxcclxuICAgICAgICAgICAgY2xvc2VIdG1sOiAnPGJ1dHRvbj4mdGltZXM7PC9idXR0b24+JyxcclxuICAgICAgICAgICAgZXh0ZW5kZWRUaW1lT3V0OiAxMDAwLFxyXG4gICAgICAgICAgICBpY29uQ2xhc3Nlczoge1xyXG4gICAgICAgICAgICAgICAgZXJyb3I6ICd0b2FzdC1lcnJvcicsXHJcbiAgICAgICAgICAgICAgICBpbmZvOiAndG9hc3QtaW5mbycsXHJcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiAndG9hc3Qtc3VjY2VzcycsXHJcbiAgICAgICAgICAgICAgICB3YXJuaW5nOiAndG9hc3Qtd2FybmluZydcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbWVzc2FnZUNsYXNzOiAndG9hc3QtbWVzc2FnZScsXHJcbiAgICAgICAgICAgIG9uSGlkZGVuOiBudWxsLFxyXG4gICAgICAgICAgICBvblNob3duOiBudWxsLFxyXG4gICAgICAgICAgICBvblRhcDogbnVsbCxcclxuICAgICAgICAgICAgcHJvZ3Jlc3NCYXI6IGZhbHNlLFxyXG4gICAgICAgICAgICB0YXBUb0Rpc21pc3M6IHRydWUsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlczoge1xyXG4gICAgICAgICAgICAgICAgdG9hc3Q6ICdkaXJlY3RpdmVzL3RvYXN0L3RvYXN0Lmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgcHJvZ3Jlc3NiYXI6ICdkaXJlY3RpdmVzL3Byb2dyZXNzYmFyL3Byb2dyZXNzYmFyLmh0bWwnXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRpbWVPdXQ6IDUwMDAsXHJcbiAgICAgICAgICAgIHRpdGxlQ2xhc3M6ICd0b2FzdC10aXRsZScsXHJcbiAgICAgICAgICAgIHRvYXN0Q2xhc3M6ICd0b2FzdCdcclxuICAgICAgICB9KTtcclxuICAgIH1dKTtcclxufSkoKTsiLCIvL3NoYXJlZC1jb21wb25lbnRzLm1vZHVsZS5qc1xyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdzaGFyZWQuY29tcG9uZW50cycsIFtdKTtcclxuICAgIH1cclxuKSgpOyIsIi8vY29uZnJtYXRpb24tbW9kYWwuY29tcG9uZW50LmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpczsgXHJcblxyXG4gICAgICAgICRjdHJsLiRvbkluaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ21vZGFsJywgJGN0cmwpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW9kdWxlLmNvbXBvbmVudCgnY29uZmlybWF0aW9uTW9kYWwnLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdGVtcGxhdGU6ICd5ZXMgb3Igbm8nLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiBbY29udHJvbGxlcl1cclxuICAgICAgICB9KTtcclxufVxyXG4pKCk7IiwiLy9wdWJsaXNoZXItbGlzdC5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ3NoYXJlZC5jb21wb25lbnRzJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcigkaHR0cCwgJHVpYk1vZGFsKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJGh0dHAuZ2V0KCdhcGkvcHVibGlzaGVyJykudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwucHVibGlzaGVycyA9IHIuZGF0YTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmNyZWF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHVpYk1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiAncHVibGlzaGVyRWRpdCcsXHJcbiAgICAgICAgICAgICAgICBiaW5kaW5nczoge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2U6IFwiPFwiXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogJ2xnJ1xyXG4gICAgICAgICAgICB9KS5yZXN1bHQudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8oXCJJIHdhcyBjbG9zZWQsIHNvIGRvIHdoYXQgSSBuZWVkIHRvIGRvIG15Q29udGVudCdzIGNvbnRyb2xsZXIgbm93LiAgUmVzdWx0IHdhcy0+XCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5pbmZvKCdyZXR1cm5pbmcgcmVzdWx0JywgcmVzdWx0KTtcclxuICAgICAgICAgICAgICAgICRjdHJsLnB1Ymxpc2hlcnMudW5zaGlmdChyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuaWQgPSByZXN1bHQuaWQ7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhcIkkgd2FzIGRpbWlzc2VkLCBzbyBkbyB3aGF0IEkgbmVlZCB0byBkbyBteUNvbnRlbnQncyBjb250cm9sbGVyIG5vdy4gIFJlYXNvbiB3YXMtPlwiICsgcmVhc29uKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5lZGl0ID0gZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgJHVpYk1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiAncHVibGlzaGVyRWRpdCcsXHJcbiAgICAgICAgICAgICAgICBiaW5kaW5nczoge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2U6IFwiPFwiXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiAkY3RybC5pZFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNpemU6ICdsZydcclxuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKCRjdHJsLnB1Ymxpc2hlcnMsIGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uaWQgPT09ICRjdHJsLmlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKGl0ZW0sIHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRjdHJsLmlkID0gaXRlbS5pZDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhcIkkgd2FzIGRpbWlzc2VkLCBzbyBkbyB3aGF0IEkgbmVlZCB0byBkbyBteUNvbnRlbnQncyBjb250cm9sbGVyIG5vdy4gIFJlYXNvbiB3YXMtPlwiICsgcmVhc29uKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3B1Ymxpc2hlclNlbGVjdCcsXHJcbiAgICB7XHJcbiAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgaWQ6ICc9J1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvY29tbW9uL3B1Ymxpc2hlci1zZWxlY3QuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgICAgIGNvbnRyb2xsZXI6IFsnJGh0dHAnLCAnJHVpYk1vZGFsJywgY29udHJvbGxlcl1cclxuICAgIH0pO1xyXG5cclxuXHJcbn1cclxuKSgpOyIsIi8vZGlyZWN0aXZlcy5tb2R1bGVzLmpzXHJcbihmdW5jdGlvbigpIHtcclxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAuZGlyZWN0aXZlcycsIFtdKTsgXHJcbn0pKCk7IiwiLy9zdFRhYmxlLmRpcmVjdGl2ZS5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwLmRpcmVjdGl2ZXMnKTtcclxuXHJcbiAgICBtb2R1bGUuZGlyZWN0aXZlKCdzdFN1Ym1pdFNlYXJjaCcsIFsnc3RDb25maWcnLCAnJHRpbWVvdXQnLCAnJHBhcnNlJywgZnVuY3Rpb24gKHN0Q29uZmlnLCAkdGltZW91dCwgJHBhcnNlKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVxdWlyZTogJ15zdFRhYmxlJyxcclxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudC5iaW5kKCdjbGljaycsXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFibGVDdHJsID0gY3RybDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVDdHJsLnBpcGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfV0pO1xyXG5cclxuICAgIG1vZHVsZS5kaXJlY3RpdmUoXCJjbGVhcktleVwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFQScsXHJcbiAgICAgICAgICAgIHJlcXVpcmU6ICduZ01vZGVsJyxcclxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbCwgYXR0cnMsIGN0cmwpIHtcclxuICAgICAgICAgICAgICAgIGVsLm9uKCdrZXlkb3duJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LndoaWNoICE9PSAyNykgeyByZXR1cm47IH0gLy8gY2hlY2sga2V5IGhvdyB5b3Ugd2FudFxyXG4gICAgICAgICAgICAgICAgICAgIGN0cmwuJHNldFZpZXdWYWx1ZShudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICBjdHJsLiRyZW5kZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICBtb2R1bGUuZGlyZWN0aXZlKFwic3RSZXNldFNlYXJjaFwiLFxyXG4gICAgICAgICAgICBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3RyaWN0OiAnRUEnLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmU6IFsnXnN0VGFibGUnLCAnXm5nTW9kZWwnXSxcclxuICAgICAgICAgICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBjdHJscykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudC5iaW5kKCdjbGljaycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vZGVsID0gY3RybHNbMV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN0cmwgPSBjdHJsc1swXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChtb2RlbC4kdmlld1ZhbHVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoa2V5LnRvTG93ZXJDYXNlKCkgPT09ICdwYWdlJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC4kdmlld1ZhbHVlW2tleV0gPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkgfHwgXy5pbmNsdWRlcyhrZXkudG9Mb3dlckNhc2UoKSwgJ3BhZ2UnKSkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLiR2aWV3VmFsdWVba2V5XSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlU3RhdGUgPSBjdHJsLnRhYmxlU3RhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVTdGF0ZS5zZWFyY2gucHJlZGljYXRlT2JqZWN0ID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlU3RhdGUucGFnaW5hdGlvbi5zdGFydCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjdHJsLnBpcGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgIG1vZHVsZS5kaXJlY3RpdmUoXCJzdENsZWFyS2V5XCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZXN0cmljdDogJ0VBJyxcclxuICAgICAgICAgICAgcmVxdWlyZTogWydec3RUYWJsZScsICdebmdNb2RlbCddLFxyXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBjdHJscykge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5vbigna2V5ZG93bicsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZ01vZGVsID0gY3RybHNbMV07XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN0cmwgPSBjdHJsc1swXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LndoaWNoID09PSAxMykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3RybC5waXBlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC53aGljaCA9PT0gMjcpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LmNvbnRleHQuYXR0cmlidXRlc1snc3Qtc2VhcmNoJ10gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpZWxkTmFtZSA9IGVsZW1lbnQuY29udGV4dC5hdHRyaWJ1dGVzWydzdC1zZWFyY2gnXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFibGVTdGF0ZSA9IGN0cmwudGFibGVTdGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlU3RhdGUuc2VhcmNoLnByZWRpY2F0ZU9iamVjdFtmaWVsZE5hbWVdID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGN0cmwucGlwZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmdNb2RlbC4kc2V0Vmlld1ZhbHVlKG51bGwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5nTW9kZWwuJHJlbmRlcigpOyAvLyB3aWxsIHVwZGF0ZSB0aGUgaW5wdXQgdmFsdWUgYXMgd2VsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcblxyXG59XHJcbikoKTsiLCIvL3Byb2R1Y3QtZWRpdC5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcihzZXJ2aWNlKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJGN0cmwudGl0bGUgPSAnTmV3IFByb2R1Y3QnOyBcclxuICAgICAgICAgICAgaWYgKCRjdHJsLnJlc29sdmUpIHtcclxuICAgICAgICAgICAgICAgICRjdHJsLmlkID0gJGN0cmwucmVzb2x2ZS5pZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoJGN0cmwuaWQpIHtcclxuICAgICAgICAgICAgICAgIHNlcnZpY2UuZ2V0UHJvZHVjdCgkY3RybC5pZCkudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgICRjdHJsLnByb2R1Y3QgPSByO1xyXG4gICAgICAgICAgICAgICAgICAgICRjdHJsLnRpdGxlID0gci50aXRsZTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkY3RybC5kaXNtaXNzKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5zYXZlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gc2VydmljZS5zYXZlKCRjdHJsLnByb2R1Y3QpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKCRjdHJsLnByb2R1Y3QsIHIpO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwubW9kYWxJbnN0YW5jZS5jbG9zZSgkY3RybC5wcm9kdWN0KTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yIHNhdmluZyBwcm9kdWN0JywgZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9KS5maW5hbGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuY29tcG9uZW50KCdwcm9kdWN0RWRpdCcsXHJcbiAgICB7XHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvcHJvZHVjdC9wcm9kdWN0LWVkaXQuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgIGlkOiAnPCcsXHJcbiAgICAgICAgICAgIHJlc29sdmU6ICc8JyxcclxuICAgICAgICAgICAgY2xvc2U6ICcmJyxcclxuICAgICAgICAgICAgZGlzbWlzczogJyYnLFxyXG4gICAgICAgICAgICBtb2RhbEluc3RhbmNlOiAnPCdcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNvbnRyb2xsZXI6IFsnUHJvZHVjdCcsIGNvbnRyb2xsZXJdXHJcbiAgICB9KTtcclxufSkoKTtcclxuICAgICIsIi8vcHJvZHVjdC1saXN0LmNvbXBvbmVudC5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcigkbW9kYWwsICRuZ0NvbmZpcm0sIHRvYXN0ciwgcHJvZHVjdCkge1xyXG4gICAgICAgIHZhciAkY3RybCA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHBhZ2VTaXplRGVmYXVsdCA9IDEwO1xyXG4gICAgICAgIHZhciB0YWJsZVN0YXRlUmVmO1xyXG5cclxuICAgICAgICAkY3RybC5zZWFyY2hNb2RlbCA9IHtcclxuICAgICAgICAgICAgcGFnZTogMSxcclxuICAgICAgICAgICAgcGFnZVNpemU6IHBhZ2VTaXplRGVmYXVsdFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRjdHJsLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdwcm9kdWN0IGxpc3QgaW5pdCcpO1xyXG4gICAgICAgICAgICAkY3RybC50aXRsZSA9ICdQcm9kdWN0IExpc3QnO1xyXG4gICAgICAgICAgICAkY3RybC5sb2FkaW5nID0gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnNlYXJjaCA9IGZ1bmN0aW9uICh0YWJsZVN0YXRlKSB7XHJcbiAgICAgICAgICAgICRjdHJsLmxvYWRpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICB0YWJsZVN0YXRlUmVmID0gdGFibGVTdGF0ZTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3NlYXJjaCcpO1xyXG4gICAgICAgICAgICBwcm9kdWN0LmdldEFsbFByb2R1Y3RzKCRjdHJsLnNlYXJjaE1vZGVsKS50aGVuKGZ1bmN0aW9uIChyKSB7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5wcm9kdWN0cyA9IHIucmVzdWx0cztcclxuICAgICAgICAgICAgICAgICRjdHJsLnNlYXJjaE1vZGVsID0gcjtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSAkY3RybC5zZWFyY2hNb2RlbC5yZXN1bHRzO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwubG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnBhZ2VkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkY3RybC5zZWFyY2godGFibGVTdGF0ZVJlZik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5jcmVhdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRtb2RhbC5vcGVuKHtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudDogJ3Byb2R1Y3RFZGl0JyxcclxuICAgICAgICAgICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kYWxJbnN0YW5jZTogXCI8XCJcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzaXplOiAnbWQnXHJcbiAgICAgICAgICAgIH0pLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICRjdHJsLnByb2R1Y3RzLnVuc2hpZnQocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIHRvYXN0ci5pbmZvKCdDcmVhdGVkICcgKyByZXN1bHQudGl0bGUpO1xyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8oXCJJIHdhcyBkaW1pc3NlZCwgc28gZG8gd2hhdCBJIG5lZWQgdG8gZG8gbXlDb250ZW50J3MgY29udHJvbGxlciBub3cuICBSZWFzb24gd2FzLT5cIiArIHJlYXNvbik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuZWRpdCA9IGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICRtb2RhbC5vcGVuKHtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudDogJ3Byb2R1Y3RFZGl0JyxcclxuICAgICAgICAgICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kYWxJbnN0YW5jZTogXCI8XCJcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGl0ZW0uaWRcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzaXplOiAnbWQnXHJcbiAgICAgICAgICAgIH0pLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKGl0ZW0sIHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICB0b2FzdHIuaW5mbygnU2F2ZWQgJyArIHJlc3VsdC50aXRsZSk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5kZWxldGUgPSBmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICAkbmdDb25maXJtKHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiAnRGVsZXRlJyxcclxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIDxiciAvPjxzdHJvbmc+JyArIGl0ZW0udGl0bGUgKyAnPC9zdHJvbmc+PycsXHJcbiAgICAgICAgICAgICAgICB0eXBlOiAncmVkJyxcclxuICAgICAgICAgICAgICAgIGJ1dHRvbnM6IHtcclxuICAgICAgICAgICAgICAgICAgICB5ZXM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAga2V5czogWyd5J10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbjogZnVuY3Rpb24gKHNjb3BlLCBidXR0b24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3QucmVtb3ZlKGl0ZW0uaWQpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWR4ID0gJGN0cmwucHJvZHVjdHMuaW5kZXhPZihpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY3RybC5wcm9kdWN0cy5zcGxpY2UoaWR4LCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2FzdHIud2FybmluZygnRGVsZXRlZCAnICsgaXRlbS50aXRsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgbm86IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAga2V5czogWydOJ10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbjogZnVuY3Rpb24gKHNjb3BlLCBidXR0b24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5zaG93RGV0YWlscyA9IGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICRtb2RhbC5vcGVuKHtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudDogJ3Byb2R1Y3RTdW1tYXJ5JyxcclxuICAgICAgICAgICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kYWxJbnN0YW5jZTogXCI8XCJcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGl0ZW0uaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYXNNb2RhbDogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNpemU6ICdtZCdcclxuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5pbmZvKFwiSSB3YXMgY2xvc2VkLCBzbyBkbyB3aGF0IEkgbmVlZCB0byBkbyBteUNvbnRlbnQncyBjb250cm9sbGVyIG5vdy4gIFJlc3VsdCB3YXMtPlwiKTtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKGl0ZW0sIHJlc3VsdCk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhcIkkgd2FzIGRpbWlzc2VkLCBzbyBkbyB3aGF0IEkgbmVlZCB0byBkbyBteUNvbnRlbnQncyBjb250cm9sbGVyIG5vdy4gIFJlYXNvbiB3YXMtPlwiICsgcmVhc29uKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3Byb2R1Y3RMaXN0JyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3Byb2R1Y3QvcHJvZHVjdC1saXN0LmNvbXBvbmVudC5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogWyckdWliTW9kYWwnLCAnJG5nQ29uZmlybScsICd0b2FzdHInLCAnUHJvZHVjdCcsIGNvbnRyb2xsZXJdXHJcbiAgICAgICAgfSk7XHJcblxyXG59XHJcbikoKTsiLCIvL3Byb2R1Y3Qtc3VtbWFyeS5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcigkbW9kYWwsIHNlcnZpY2UpIHtcclxuICAgICAgICB2YXIgJGN0cmwgPSB0aGlzO1xyXG5cclxuICAgICAgICAkY3RybC4kb25Jbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoJGN0cmwucmVzb2x2ZSkge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuaWQgPSAkY3RybC5yZXNvbHZlLmlkO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuYXNNb2RhbCA9ICRjdHJsLnJlc29sdmUuYXNNb2RhbDtcclxuICAgICAgICAgICAgICAgICRjdHJsLmFkZFN0YWZmVmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzZXJ2aWNlLmdldFByb2R1Y3QoJGN0cmwuaWQpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgICRjdHJsLnByb2R1Y3QgPSByO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmVkaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJG1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiAncHJvZHVjdEVkaXQnLFxyXG4gICAgICAgICAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlOiBcIjxcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBpZDogJGN0cmwucHJvZHVjdC5pZFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNpemU6ICdtZCdcclxuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoJGN0cmwucHJvZHVjdCwgcmVzdWx0KTtcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnNob3dOZXdTdGFmZiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkbW9kYWwub3Blbih7XHJcbiAgICAgICAgICAgICAgICBjb21wb25lbnQ6ICdzdGFmZkVkaXQnLFxyXG4gICAgICAgICAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlOiBcIjxcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6ICRjdHJsLmlkXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogJ21kJ1xyXG4gICAgICAgICAgICB9KS5yZXN1bHQudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8oXCJJIHdhcyBjbG9zZWQsIHNvIGRvIHdoYXQgSSBuZWVkIHRvIGRvIG15Q29udGVudCdzIGNvbnRyb2xsZXIgbm93LiAgUmVzdWx0IHdhcy0+XCIpO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwucHJvZHVjdC5zdGFmZi51bnNoaWZ0KHJlc3VsdCk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhcIkkgd2FzIGRpbWlzc2VkLCBzbyBkbyB3aGF0IEkgbmVlZCB0byBkbyBteUNvbnRlbnQncyBjb250cm9sbGVyIG5vdy4gIFJlYXNvbiB3YXMtPlwiICsgcmVhc29uKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRjdHJsLm1vZGFsSW5zdGFuY2UuY2xvc2UoJGN0cmwucHJvZHVjdCk7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuY29tcG9uZW50KCdwcm9kdWN0U3VtbWFyeScsXHJcbiAgICB7XHJcbiAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgaWQ6ICc8JyxcclxuICAgICAgICAgICAgYXNNb2RhbDogJzwnLFxyXG4gICAgICAgICAgICByZXNvbHZlOiAnPCcsXHJcbiAgICAgICAgICAgIGNsb3NlOiAnJicsXHJcbiAgICAgICAgICAgIGRpc21pc3M6ICcmJywgXHJcbiAgICAgICAgICAgIG1vZGFsSW5zdGFuY2U6ICc8J1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvcHJvZHVjdC9wcm9kdWN0LXN1bW1hcnkuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgICAgIGNvbnRyb2xsZXI6IFsnJHVpYk1vZGFsJywgJ1Byb2R1Y3QnLCBjb250cm9sbGVyXVxyXG4gICAgfSk7XHJcblxyXG59XHJcbikoKTsiLCIvL3Byb2R1Y3Quc2VydmljZS5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnKTsgXHJcbiAgICBcclxuICAgIG1vZHVsZS5mYWN0b3J5KCdQcm9kdWN0JywgWyckaHR0cCcsIHNlcnZpY2VDb250cm9sbGVyXSk7XHJcblxyXG4gICAgZnVuY3Rpb24gc2VydmljZUNvbnRyb2xsZXIoJGh0dHApIHtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgZ2V0UHJvZHVjdDogZ2V0UHJvZHVjdCxcclxuICAgICAgICAgICAgZ2V0QWxsUHJvZHVjdHM6IGdldEFsbFByb2R1Y3RzLFxyXG4gICAgICAgICAgICByZW1vdmU6IHJlbW92ZSwgXHJcbiAgICAgICAgICAgIHNhdmU6IHNhdmVcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZXRQcm9kdWN0KGlkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJ2FwaS9wcm9kdWN0LycgKyBpZCkudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHIuZGF0YTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldEFsbFByb2R1Y3RzKHNlYXJjaE1vZGVsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJ2FwaS9wcm9kdWN0JywgeyBwYXJhbXM6IHNlYXJjaE1vZGVsIH0pLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByLmRhdGE7XHJcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVyci5tZXNzYWdlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiByZW1vdmUoaWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLmRlbGV0ZSgnYXBpL3Byb2R1Y3QvJyArIGlkKS50aGVuKGZ1bmN0aW9uKHIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByLmRhdGE7XHJcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9KTsgXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzYXZlKHByb2R1Y3QpIHtcclxuICAgICAgICAgICAgaWYgKHByb2R1Y3QuaWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAkaHR0cC5wdXQoJ2FwaS9wcm9kdWN0JywgcHJvZHVjdCkudGhlbihmdW5jdGlvbihyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHIuZGF0YTtcclxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlcnIubWVzc2FnZTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJ2FwaS9wcm9kdWN0JywgcHJvZHVjdCkudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByLmRhdGE7XHJcbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVyci5tZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxufVxyXG4pKCk7IiwiLy9zdGFmZi1lZGl0LmNvbXBvbmVudC5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnKTtcclxuXHJcbiAgICBmdW5jdGlvbiBjb250cm9sbGVyKCRodHRwKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3N0YWZmIGVkaXQgaW5pdCcpO1xyXG4gICAgICAgICAgICAkY3RybC50aXRsZSA9ICdOZXcgU3RhZmYnO1xyXG5cclxuICAgICAgICAgICAgaWYgKCRjdHJsLnJlc29sdmUpICRjdHJsLnByb2R1Y3RJZCA9ICRjdHJsLnJlc29sdmUucHJvZHVjdElkO1xyXG5cclxuICAgICAgICAgICAgaWYgKCRjdHJsLnJlc29sdmUuc3RhZmYpIHtcclxuICAgICAgICAgICAgICAgICRjdHJsLnN0YWZmID0gJGN0cmwucmVzb2x2ZS5zdGFmZjtcclxuICAgICAgICAgICAgICAgICRjdHJsLnRpdGxlID0gJGN0cmwuc3RhZmYuZmlyc3RuYW1lICsgJyAnICsgJGN0cmwuc3RhZmYubGFzdG5hbWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJGN0cmwuZGlzbWlzcygpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRjdHJsLnNhdmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICgkY3RybC5wcm9kdWN0SWQpIHtcclxuICAgICAgICAgICAgICAgICRodHRwLnBvc3QoJ2FwaS9zdGFmZi8nICsgJGN0cmwucHJvZHVjdElkLCAkY3RybC5zdGFmZikudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKCRjdHJsLnN0YWZmLCByLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICRjdHJsLm1vZGFsSW5zdGFuY2UuY2xvc2Uoci5kYXRhKTtcclxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc29tZXRoaW5nIHdlbnQgd3JvbmcnLCBlcnIubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICRodHRwLnBvc3QoJ2FwaS9zdGFmZicsICRjdHJsLnN0YWZmKS50aGVuKGZ1bmN0aW9uIChyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoJGN0cmwuc3RhZmYsIHIuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJGN0cmwubW9kYWxJbnN0YW5jZS5jbG9zZShyLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzb21ldGhpbmcgd2VudCB3cm9uZycsIGVyci5tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuY29tcG9uZW50KCdzdGFmZkVkaXQnLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6ICc8JyxcclxuICAgICAgICAgICAgICAgIGNsb3NlOiAnJicsXHJcbiAgICAgICAgICAgICAgICBkaXNtaXNzOiAnJicsXHJcbiAgICAgICAgICAgICAgICBzdGFmZjogJzwnLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiAnPCcsXHJcbiAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlOiAnPCdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvc3RhZmYvc3RhZmYtZWRpdC5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJGh0dHAnLCBjb250cm9sbGVyXVxyXG4gICAgICAgIH0pO1xyXG59XHJcbikoKTsiLCIvL3N0YWZmLWxpc3QuY29tcG9uZW50LmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoJGh0dHAsICRtb2RhbCwgJG5nQ29uZmlybSkge1xyXG4gICAgICAgIHZhciAkY3RybCA9IHRoaXM7XHJcblxyXG4gICAgICAgICRjdHJsLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzdGFmZiBsaXN0IGluaXQnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmVkaXQgPSBmdW5jdGlvbiAobWVtYmVyKSB7XHJcbiAgICAgICAgICAgICRtb2RhbC5vcGVuKHtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudDogJ3N0YWZmRWRpdCcsXHJcbiAgICAgICAgICAgICAgICBiaW5kaW5nczoge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2U6IFwiPFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHN0YWZmOiBtZW1iZXJcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RhZmY6IG1lbWJlclxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNpemU6ICdtZCdcclxuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5pbmZvKFwiSSB3YXMgY2xvc2VkLCBzbyBkbyB3aGF0IEkgbmVlZCB0byBkbyBteUNvbnRlbnQncyBjb250cm9sbGVyIG5vdy4gIFJlc3VsdCB3YXMtPlwiKTtcclxuXHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhcIkkgd2FzIGRpbWlzc2VkLCBzbyBkbyB3aGF0IEkgbmVlZCB0byBkbyBteUNvbnRlbnQncyBjb250cm9sbGVyIG5vdy4gIFJlYXNvbiB3YXMtPlwiICsgcmVhc29uKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5kZWxldGUgPSBmdW5jdGlvbiAobWVtYmVyKSB7XHJcbiAgICAgICAgICAgICRuZ0NvbmZpcm0oe1xyXG4gICAgICAgICAgICAgICAgdGl0bGU6ICdEZWxldGUnLFxyXG4gICAgICAgICAgICAgICAgY29udGVudDogJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgPGJyIC8+PHN0cm9uZz4nICsgbWVtYmVyLmZpcnN0bmFtZSArIG1lbWJlci5sYXN0bmFtZSArICc8L3N0cm9uZz4/JyxcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdyZWQnLFxyXG4gICAgICAgICAgICAgICAgYnV0dG9uczoge1xyXG4gICAgICAgICAgICAgICAgICAgIHllczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXlzOiBbJ3knXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBmdW5jdGlvbiAoc2NvcGUsIGJ1dHRvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGh0dHAuZGVsZXRlKCdhcGkvc3RhZmYvJyArIG1lbWJlci5pZCkudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZHggPSAkY3RybC5zdGFmZi5pbmRleE9mKG1lbWJlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGN0cmwuc3RhZmYuc3BsaWNlKGlkeCwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Vycm9yJywgZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIG5vOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleXM6IFsnTiddLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb246IGZ1bmN0aW9uIChzY29wZSwgYnV0dG9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3N0YWZmTGlzdCcsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiaW5kaW5nczoge1xyXG4gICAgICAgICAgICAgICAgc3RhZmY6ICc8J1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9zdGFmZi9zdGFmZi1saXN0LmNvbXBvbmVudC5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogWyckaHR0cCcsICckdWliTW9kYWwnLCAnJG5nQ29uZmlybScsIGNvbnRyb2xsZXJdXHJcbiAgICAgICAgfSk7XHJcbn1cclxuKSgpOyJdfQ==
